

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Clustering metrics &#8212; ML book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'unsupervised_learning/clustering_metrics';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="K-means" href="k_means.html" />
    <link rel="prev" title="Principal components analysis (PCA)" href="pca.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="ML book - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="ML book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    ML book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction to ML</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro/intro_to_ML.html">Overview</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/definition.html">Definitions of ML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/applications.html">Applications of ML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/data.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/ml_types.html">Types of ML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/knn.html">k-Nearest Neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/model_selection.html">Model selection</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lin_reg/linear_regression.html">Linear regression</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lin_reg/simple.html">Simple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lin_reg/polynomial.html">Polynomial regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lin_reg/multiple.html">Multiple linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lin_reg/regularization.html">Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lin_reg/numeric_opt.html">Numeric optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lin_reg/general.html">General linear model</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../linear_classification/classification.html">Linear classification</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../linear_classification/log_reg.html">Logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linear_classification/multi_log_reg.html">Multinomial logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linear_classification/num_opt_log_reg.html">Numeric optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../linear_classification/svm.html">Support Vector Machines (SVM)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../eval_metrics/metrics.html">Evaluation Metrics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../eval_metrics/classification.html">Classification Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eval_metrics/ROC-AUC.html">ROC-AUC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eval_metrics/regression.html">Regression metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eval_metrics/cross_val.html">Cross-validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eval_metrics/hyperparameters.html">Hyperparameters tuning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../probabilistic_models/probabilistic.html">Probabilistic models</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../probabilistic_models/bayesian_inference.html">Bayesian inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probabilistic_models/lin_reg_prob.html">Probabilistic models for linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probabilistic_models/log_reg_prob.html">Probabilistic models for logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probabilistic_models/LDA.html">Linear Discriminant Analysis (QDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probabilistic_models/QDA.html">Quadratic Discriminant Analysis (QDA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../probabilistic_models/naive_bayes.html">Naive Bayes classifier</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../decision_trees/decision_tree.html">Decision Trees</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../decision_trees/classification.html">Classification tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../decision_trees/regression.html">Regression tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../decision_trees/impurity.html">Impurity and information criterions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../decision_trees/pruning.html">Tree pruning</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../ensembling/ensemble.html">Ensembling</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../ensembling/bias_variance.html">Bias-variance decomposition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ensembling/voting_stacking_blending.html">Voting, stacking and blending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ensembling/bagging.html">Bagging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ensembling/random_forest.html">Random forests</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../gradient_boosting/gradient_boosting.html">Gradient boosting</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../gradient_boosting/boosting.html">Boosting and additive modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gradient_boosting/generic_gb.html">Generic gradient boosting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gradient_boosting/adaboost.html">AdaBoost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gradient_boosting/xgboost.html">XGBoost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gradient_boosting/catboost.html">CatBoost</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="unsupervised.html">Unsupervised Learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="pca.html">Principal components analysis (PCA)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Clustering metrics</a></li>

<li class="toctree-l2"><a class="reference internal" href="k_means.html">K-means</a></li>
<li class="toctree-l2"><a class="reference internal" href="hierarchic_clustering.html">Hierarchical Clustering</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Deep Learning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mlp/mlp.html">Multilayer perceptron (MLP)</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../mlp/layers.html">Layers of MLP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlp/forward_backward_pass.html">Forward and backward pass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlp/activations.html">Activation functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlp/backprop.html">Back propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlp/weight_init.html">Weights initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlp/regularization.html">Regularization in MLP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mlp/optimization_dl.html">Optimization in DL</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cnn/cnn.html">CNN</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../cnn/convolutions_2d.html">Convolution of matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cnn/convolutions_3d.html">Convolutions of tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cnn/pooling.html">Pooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cnn/back_prop.html">Back propagation in CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cnn/augmentation.html">Data augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cnn/architectures.html">Architectures of CNN</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rnn/sequential.html">Sequential NNs</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../rnn/vanilla_rnn.html">Vanilla RNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rnn/lstm.html">LSTM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rnn/gru.html">GRU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rnn/attention.html">Attention</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rnn/transformers.html">Transformers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../gm/generative.html">Generative models</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../gm/autoencoders.html">Autoencoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gm/vae.html">Variational autoencoders (VAE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gm/gan.html">Ganerative adversarial networks (GAN)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rl/RL.html">Reinforcement Learning</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../rl/basics.html">RL basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rl/multiarmed_bandits.html">Multiarmed bandits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rl/mdp.html">Markov decision process (MDP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rl/q_learning.html">Q-learning</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python for ML</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../python/python_basics.html">Python Basics</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../python/basics/basic_types.html">Basic Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/basics/variables.html">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/basics/control_flow.html">Control flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/basics/functions_strings.html">Functions</a></li>

<li class="toctree-l2"><a class="reference internal" href="../python/basics/classes.html">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python/basics/ISLP_lab.html">ISLP Lab</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../python/numpy.html">NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/pandas.html">Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/visual.html">Data visualization</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Math for ML</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/linear_algebra.html">Linear Algebra</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/vectors.html">Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/matrices.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/linear_systems.html">Linear systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/inverse.html">Inverse matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/rank.html">Rank of a matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/orthogonality.html">Orthogonality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/projections.html">Orthogonal projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/determinant.html">Determinants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/eig.html">Eigenvalues and eigenvectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/diagonalize.html">Diagonalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/matrix_norms.html">Matrix norms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/lin_alg/SVD.html">Singular Value Decomposition (SVD)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/calculus.html">Calculus</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/calculus/1-d.html">1-d calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/calculus/multivariate.html">Multivariate calculus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/calculus/matrix_diff.html">Matrix calculus</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/probability.html">Probability</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/proba/entropy.html">Entropy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/statistics.html">Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/stats/MLE.html">Maximum likelihood estimation (MLE)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../math/optimization.html">Optimization</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../math/optimization/GD.html">Gradient descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/optimization/SGD.html">Stochastic gradient descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/optimization/newton.html">Newton’s method</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notation.html">Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">ML resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/unsupervised_learning/clustering_metrics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Clustering metrics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Clustering metrics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#silhouette-score">Silhouette Score</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-silhouette-score-in-python">Calculating Silhouette Score in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#davies-bouldin-index">Davies-Bouldin Index</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-vs-higher-db-index-values">Lower vs. Higher DB Index Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syntax">Syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-2">Implementation 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question">Question</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusted-rand-index-ari">Adjusted Rand Index (ARI)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-digits-dataset">Example: Digits Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calinski-harabasz-index">Calinski-Harabasz index</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-you-interpret-calinski-harabasz-index">How do you interpret Calinski-Harabasz index?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calinski-harabasz-index-example-in-python">Calinski-Harabasz Index Example in Python</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="clustering-metrics">
<h1>Clustering metrics<a class="headerlink" href="#clustering-metrics" title="Permalink to this heading">#</a></h1>
<p>Clustering is a fundamental technique in unsupervised machine learning that involves grouping similar data points together to uncover underlying patterns or structures in a dataset. To evaluate the performance and quality of clustering algorithms, various metrics are employed to assess how well the algorithm has grouped the data.
Among the key clustering metrics, <strong>Silhouette Score</strong>, <strong>Davies-Bouldin Index</strong>, <strong>Calinski-Harabasz Index</strong>, and <strong>Adjusted Rand Index (ARI)</strong> stand out as widely used measures. Each of these metrics offers a unique perspective on the effectiveness of the clustering algorithms</p>
<p>Notably, the information on these metrics and their applications was particularly helpful, and a <strong><a class="reference external" href="https://t.me/HandsOnMachineLearning/2">great book</a></strong> on machine learning provided valuable input.</p>
<section id="silhouette-score">
<h2>Silhouette Score<a class="headerlink" href="#silhouette-score" title="Permalink to this heading">#</a></h2>
<p>The Silhouette Score is a metric used to calculate the goodness of a clustering technique for a given dataset. It measures how well-defined the clusters in the data are. The score is based on both the average distance between data points within the same cluster (cohesion) and the average distance between different clusters (separation).</p>
<p>The Silhouette Score for the <em>i</em>-th data point, denoted as <em>s(i)</em>, is given by:</p>
<div class="math notranslate nohighlight">
\[ S(i) = \frac{b(i) - a(i)}{\max\{a(i), b(i)\}}\]</div>
<ul class="simple">
<li><p><em>a(i)</em>: The average distance from the ith data point to the other data points in the same cluster. It represents cohesion.</p></li>
<li><p><em>b(i)</em>: The average distance from the ith data point to the data points in the nearest cluster (i.e., the cluster that the data point is not a part of). It represents separation.</p></li>
</ul>
<p>The overall Silhouette Score for the entire dataset is usually computed as the average of the <em>S(i)</em> values for all data points</p>
<div class="math notranslate nohighlight">
\[\text{Silhouette Score} = \frac{1}{n} \sum_{i=1}^{n}S(i)\]</div>
<ul class="simple">
<li><p><em>n</em>: The number of data points in the dataset.</p></li>
<li><p><em>S(i)</em>: The Silhouette Score for the ith data point.</p></li>
</ul>
<p>Range of Values:</p>
<ul class="simple">
<li><p><strong>-1:</strong> indicates that the data point has been assigned to the wrong cluster. It implies that the data point is better matched to the neighboring clusters than to its own cluster. This scenario suggests a poor clustering result with substantial overlap between clusters.</p></li>
<li><p><strong>0:</strong> indicates that the data point is on the boundary between two clusters. It means that the average distance to points in its own cluster is comparable to the average distance to points in the nearest cluster. This situation suggests overlapping or unclear cluster boundaries</p></li>
<li><p><strong>1:</strong> indicates that the data point is we-l matched to its own cluster and poorly matched to neighboring clusters. This is an ideal scenario, suggesting distinct, well-defined clusters with clear boundaries.</p></li>
</ul>
<section id="calculating-silhouette-score-in-python">
<h3>Calculating Silhouette Score in Python<a class="headerlink" href="#calculating-silhouette-score-in-python" title="Permalink to this heading">#</a></h3>
<p>The Silhouette Score in Python can be computed using the <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> library</p>
<p>Step 1 - Step 6 удалил для наглядности,  а так это у тебя это уже есть</p>
<p>This code generates a synthetic dataset with 300 data points distributed among three clusters using the <code class="docutils literal notranslate"><span class="pre">make_blobs</span></code> function. It then applies the KMeans clustering algorithm with three clusters (<code class="docutils literal notranslate"><span class="pre">k=3</span></code>) to the data. The script visualizes the original data and the clustering result with centroids using Matplotlib. Finally, it calculates and prints the silhouette score, a metric that quantifies the quality of the clustering, with a higher score indicating better-defined clusters. In this specific example, <strong>the silhouette score for three clusters is approximately 0.85</strong>, suggesting that the data is well-clustered.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">silhouette_samples</span><span class="p">,</span> <span class="n">silhouette_score</span>
<span class="kn">from</span> <span class="nn">jupyterquiz</span> <span class="kn">import</span> <span class="n">display_quiz</span>

<span class="c1"># Generating the sample data from make_blobs</span>
<span class="c1"># This particular setting has one distinct cluster and 3 clusters placed close</span>
<span class="c1"># together.</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">centers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">cluster_std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">center_box</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># For reproducibility</span>

<span class="n">range_n_clusters</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="k">for</span> <span class="n">n_clusters</span> <span class="ow">in</span> <span class="n">range_n_clusters</span><span class="p">:</span>
    <span class="c1"># Create a subplot with 1 row and 2 columns</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

    <span class="c1"># The 1st subplot is the silhouette plot</span>
    <span class="c1"># The silhouette coefficient can range from -1, 1 but in this example all</span>
    <span class="c1"># lie within [-0.1, 1]</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># The (n_clusters+1)*10 is for inserting blank space between silhouette</span>
    <span class="c1"># plots of individual clusters, to demarcate them clearly.</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">n_clusters</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span><span class="p">])</span>

    <span class="c1"># Initialize the clusterer with n_clusters value and a random generator</span>
    <span class="c1"># seed of 10 for reproducibility.</span>
    <span class="n">clusterer</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">n_init</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># The silhouette_score gives the average value for all the samples.</span>
    <span class="c1"># This gives a perspective into the density and separation of the formed</span>
    <span class="c1"># clusters</span>
    <span class="n">silhouette_avg</span> <span class="o">=</span> <span class="n">silhouette_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;For n_clusters =&quot;</span><span class="p">,</span>
        <span class="n">n_clusters</span><span class="p">,</span>
        <span class="s2">&quot;The average silhouette_score is :&quot;</span><span class="p">,</span>
        <span class="n">silhouette_avg</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Compute the silhouette scores for each sample</span>
    <span class="n">sample_silhouette_values</span> <span class="o">=</span> <span class="n">silhouette_samples</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">cluster_labels</span><span class="p">)</span>

    <span class="n">y_lower</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
        <span class="c1"># Aggregate the silhouette scores for samples belonging to</span>
        <span class="c1"># cluster i, and sort them</span>
        <span class="n">ith_cluster_silhouette_values</span> <span class="o">=</span> <span class="n">sample_silhouette_values</span><span class="p">[</span><span class="n">cluster_labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>

        <span class="n">ith_cluster_silhouette_values</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">size_cluster_i</span> <span class="o">=</span> <span class="n">ith_cluster_silhouette_values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">y_upper</span> <span class="o">=</span> <span class="n">y_lower</span> <span class="o">+</span> <span class="n">size_cluster_i</span>

        <span class="n">color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">nipy_spectral</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_clusters</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">y_lower</span><span class="p">,</span> <span class="n">y_upper</span><span class="p">),</span>
            <span class="mi">0</span><span class="p">,</span>
            <span class="n">ith_cluster_silhouette_values</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Label the silhouette plots with their cluster numbers at the middle</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">y_lower</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">size_cluster_i</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

        <span class="c1"># Compute the new y_lower for next plot</span>
        <span class="n">y_lower</span> <span class="o">=</span> <span class="n">y_upper</span> <span class="o">+</span> <span class="mi">10</span>  <span class="c1"># 10 for the 0 samples</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;The silhouette plot for the various clusters.&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;The silhouette coefficient values&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cluster label&quot;</span><span class="p">)</span>

    <span class="c1"># The vertical line for average silhouette score of all the values</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">silhouette_avg</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>  <span class="c1"># Clear the yaxis labels / ticks</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="c1"># 2nd Plot showing the actual clusters formed</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">nipy_spectral</span><span class="p">(</span><span class="n">cluster_labels</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_clusters</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Labeling the clusters</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="n">clusterer</span><span class="o">.</span><span class="n">cluster_centers_</span>
    <span class="c1"># Draw white circles at cluster centers</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">centers</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">centers</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">c</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">centers</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;$</span><span class="si">%d</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;The visualization of the clustered data.&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Feature space for the 1st feature&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Feature space for the 2nd feature&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span>
        <span class="s2">&quot;Silhouette analysis for KMeans clustering on sample data with n_clusters = </span><span class="si">%d</span><span class="s2">&quot;</span>
        <span class="o">%</span> <span class="n">n_clusters</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
        <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">,</span>
    <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For n_clusters = 2 The average silhouette_score is : 0.7049787496083262
For n_clusters = 3 The average silhouette_score is : 0.5882004012129721
For n_clusters = 4 The average silhouette_score is : 0.6505186632729437
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>For n_clusters = 5 The average silhouette_score is : 0.561464362648773
For n_clusters = 6 The average silhouette_score is : 0.4857596147013469
</pre></div>
</div>
<img alt="../_images/073718e4ec7de142db631155ddd9d61337f2328593e8b18e8c2172d27187a240.png" src="../_images/073718e4ec7de142db631155ddd9d61337f2328593e8b18e8c2172d27187a240.png" />
<img alt="../_images/829a66ed0b3016945c00f77a53ac0e23051e7af05f5adea75f3a8c743d93218d.png" src="../_images/829a66ed0b3016945c00f77a53ac0e23051e7af05f5adea75f3a8c743d93218d.png" />
<img alt="../_images/2399e461c5e5a4e31578948f3a222ecb56ea607a2922bf069d96020600dd33a0.png" src="../_images/2399e461c5e5a4e31578948f3a222ecb56ea607a2922bf069d96020600dd33a0.png" />
<img alt="../_images/1d706530c4e88eb6864417e657dd06f32473b25f32e560023bf2a6b580ef39cf.png" src="../_images/1d706530c4e88eb6864417e657dd06f32473b25f32e560023bf2a6b580ef39cf.png" />
<img alt="../_images/60ba092751bf6ee873b1b624994723caa964b9872274fbf9c1daacf02dd4c8cc.png" src="../_images/60ba092751bf6ee873b1b624994723caa964b9872274fbf9c1daacf02dd4c8cc.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://github.com/Azamat002/clustering-metrics/blob/master/silho_dem.gif?raw=true"></div></div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>You are provided with a simple dataset consisting of two data points and their cluster assignments. Your task is to calculate the Silhouette Score for each data point. The Silhouette Score measures how similar a data point is to its own cluster compared to other clusters.</p>
<ul class="simple">
<li><p>Data</p></li>
</ul>
<ul class="simple">
<li><p>Data point 1: [1, 2] (Cluster 1) <br></p></li>
<li><p>Data point 2: [4, 5] (Cluster 2) <br></p></li>
</ul>
<ul class="simple">
<li><p>Cluster Assignment</p></li>
</ul>
<ul class="simple">
<li><p>Data point 1 is assigned to Cluster 1 <br></p></li>
<li><p>Data point 2 is assigned to Cluster 2 <br></p></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can check your answer or see the explanation below</p>
</div>
<div style="display:none" id="q_silh_calc">W3sicXVlc3Rpb24iOiAiWW91ciByZXNwb25zZSBmb3IgVGFzayBBIiwgInR5cGUiOiAibnVtZXJpYyIsICJhbnN3ZXJzIjogW3sidHlwZSI6ICJ2YWx1ZSIsICJ2YWx1ZSI6IDAsICJjb3JyZWN0IjogdHJ1ZSwgImZlZWRiYWNrIjogIkV4Y2VsbGVudCEgWW91IGNvcnJlY3RseSBjYWxjdWxhdGVkIHRoZSBTaWxob3VldHRlIFNjb3JlLiBXZWxsIGRvbmUhIn0sIHsidHlwZSI6ICJkZWZhdWx0IiwgImZlZWRiYWNrIjogIk9vcHMhIERvdWJsZS1jaGVjayB0aGUgU2lsaG91ZXR0ZSBTY29yZSBmb3JtdWxhIGFuZCB0cnkgYWdhaW4uIn1dfV0=</div><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="NdpoArGBPCHu" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#NdpoArGBPCHu {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_silh_calc");
            var questionsNdpoArGBPCHu;
            try {
               questionsNdpoArGBPCHu=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionsNdpoArGBPCHu = JSON.parse(element.innerHTML);
            }
            console.log(questionsNdpoArGBPCHu);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("NdpoArGBPCHu")) {
            show_questions(questionsNdpoArGBPCHu,  NdpoArGBPCHu); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("NdpoArGBPCHu");
        // console.log(document.getElementById("NdpoArGBPCHu"));

        try_show();
        }
        </script></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Explanation!</p>
<p class="rubric">Step 1: Calculate average distance (a) for each data point</p>
<p><span class="math notranslate nohighlight">\( a_1 = \frac{d([1, 2], [4, 5])}{1} \)</span> <br>
<span class="math notranslate nohighlight">\( a_1 = \sqrt{(1-4)^2 + (2-5)^2} = \sqrt{18} \)</span> <br>
<span class="math notranslate nohighlight">\( a_1 = 3\sqrt{2} \)</span> <br>
<span class="math notranslate nohighlight">\( a_2 = \frac{d([4, 5], [1, 2])}{1} \)</span> <br>
<span class="math notranslate nohighlight">\( a_2 = \sqrt{(4-1)^2 + (5-2)^2} = \sqrt{18} \)</span> <br>
<span class="math notranslate nohighlight">\( a_2 = 3\sqrt{2} \)</span> <br></p>
<p class="rubric">Step 2: Calculate average distance (b) for each data point</p>
<p><span class="math notranslate nohighlight">\( b_1 = \min (\frac{d([1, 2], [4, 5])}{1}) \)</span> <br>
<span class="math notranslate nohighlight">\( b_1 = \sqrt{(1-4)^2 + (2-5)^2} = \sqrt{18} \)</span> <br>
<span class="math notranslate nohighlight">\( b_1 = 3\sqrt{2} \)</span> <br>
<span class="math notranslate nohighlight">\( b_2 = \min (\frac{d([4, 5], [1, 2])}{1}) \)</span> <br>
<span class="math notranslate nohighlight">\( b_2 = \sqrt{(4-1)^2 + (5-2)^2} = \sqrt{18}\)</span>  <br>
<span class="math notranslate nohighlight">\( b_2 = 3\sqrt{2} \)</span></p>
<p class="rubric">Step 3: Calculate the Silhouette Score for each data point</p>
<p><span class="math notranslate nohighlight">\( s_1 = \frac{b_1 - a_1}{\max(a_1, b_1)}\)</span>  <br>
<span class="math notranslate nohighlight">\( s_1 = \frac{3\sqrt{2} - 3\sqrt{2}}{\max(3\sqrt{2}, 3\sqrt{2})}\)</span> <br>
<span class="math notranslate nohighlight">\( s_1 = \frac{0}{3\sqrt{2}}\)</span> <br>
<span class="math notranslate nohighlight">\( s_1 = 0\)</span></p>
<p><span class="math notranslate nohighlight">\( s_2 = \frac{b_2 - a_2}{\max(a_2, b_2)}\)</span>  <br>
<span class="math notranslate nohighlight">\( s_2 = \frac{3\sqrt{2} - 3\sqrt{2}}{\max(3\sqrt{2}, 3\sqrt{2})}\)</span> <br>
<span class="math notranslate nohighlight">\( s_2 = \frac{0}{3\sqrt{2}}\)</span> <br>
<span class="math notranslate nohighlight">\( s_2 = 0\)</span></p>
</div>
</section>
</section>
<section id="davies-bouldin-index">
<h2>Davies-Bouldin Index<a class="headerlink" href="#davies-bouldin-index" title="Permalink to this heading">#</a></h2>
<p>The Davis-Buldin index is a validation metric that is used to evaluate clustering models. It is determined by averaging each cluster’s resemblance to the cluster that is closest to it. Here, the ratio of the intracluster to the intercluster distance is used to quantify similarity.</p>
<p>The following formula can be used to determine the Davis-Boldin index for a given data set:</p>
<div class="math notranslate nohighlight">
\[
DB = \frac{1}{n} \sum_{i=1}^{n} \max_{j\neq i} \left( \frac{S_i + S_j}{M_{ij}} \right)
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(n\)</span> is the total number of clusters.</p></li>
<li><p><span class="math notranslate nohighlight">\(S_i\)</span> is the average similarity of cluster <span class="math notranslate nohighlight">\(S_i\)</span> (compactness).</p></li>
<li><p><span class="math notranslate nohighlight">\(M_{ij}\)</span> is the similarity between clusters <span class="math notranslate nohighlight">\(S_i\)</span> and <span class="math notranslate nohighlight">\(S_j\)</span> (separation).</p></li>
</ul>
<ol class="arabic simple">
<li><p><strong>Compactness (<span class="math notranslate nohighlight">\(S_i\)</span>):</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(S_i\)</span> represents the average similarity within cluster <span class="math notranslate nohighlight">\(i\)</span>, or the compactness of the cluster.</p></li>
<li><p>The similarity within a cluster is typically calculated using the average distance or dissimilarity between pairs of points within that cluster.</p></li>
<li><p>The specific measure of similarity (or dissimilarity) depends on the distance metric chosen for the clustering algorithm. For example, if Euclidean distance is used, <span class="math notranslate nohighlight">\(S_i\)</span> might be the average Euclidean distance between all pairs of points in cluster <span class="math notranslate nohighlight">\(i\)</span>.</p></li>
</ul>
</li>
<li><p><strong>Separation (<span class="math notranslate nohighlight">\(M_{ij}\)</span>):</strong></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(M_{ij}\)</span> represents the similarity between clusters <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, or the separation between the clusters.</p></li>
<li><p>Similar to compactness, the measure of similarity between clusters depends on the chosen distance metric. It is often the distance or dissimilarity between the centroids (center points) of the clusters.</p></li>
<li><p>The smaller <span class="math notranslate nohighlight">\(M_{ij}\)</span>, the better, as it indicates that the clusters are well separated.</p></li>
</ul>
</li>
</ol>
<section id="lower-vs-higher-db-index-values">
<h3>Lower vs. Higher DB Index Values<a class="headerlink" href="#lower-vs-higher-db-index-values" title="Permalink to this heading">#</a></h3>
<p>DBI is a relative clustering validity index, meaning that it compares the clustering results to a hypothetical “ideal” clustering. A lower DBI value indicates a better clustering solution.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<ul class="simple">
<li><p>Higher DB index values correspond to poorer clustering solutions. This is because a higher DBI value indicates that the clusters are not well-separated and/or that the clusters are not compact.</p></li>
<li><p>However, a lower DB index value is desirable. It indicates that the clusters are well-separated and compact, which is often a good indication of a successful clustering solution.</p></li>
</ul>
</div>
</section>
<section id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this heading">#</a></h3>
<p>The davies_bouldin_score can be accessed through the scikit-learn library’s sklearn.metrics module. The recommended syntax for utilization is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">davies_bouldin_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="implementation">
<h3>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">#</a></h3>
<p>Below is the Python implementation of DB index using the sklearn library</p>
<p>The code conducts Agglomerative Hierarchical Clustering (AHC) on the Wine dataset and computes the Davies-Bouldin Index (DBI) to assess the quality of the clustering outcomes. Additionally, it generates a dendrogram to visually represent the hierarchical organization of the data.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_wine</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">AgglomerativeClustering</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">davies_bouldin_score</span>
<span class="kn">from</span> <span class="nn">scipy.cluster.hierarchy</span> <span class="kn">import</span> <span class="n">dendrogram</span><span class="p">,</span> <span class="n">linkage</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Load the Wine dataset</span>
<span class="n">wine</span> <span class="o">=</span> <span class="n">load_wine</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">wine</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># Perform Agglomerative Hierarchical Clustering</span>
<span class="n">agg_clustering</span> <span class="o">=</span> <span class="n">AgglomerativeClustering</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">agg_clustering</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Get the cluster labels</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">agg_clustering</span><span class="o">.</span><span class="n">labels_</span>

<span class="c1"># Calculate Davies-Bouldin Index</span>
<span class="n">db_index</span> <span class="o">=</span> <span class="n">davies_bouldin_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Davies-Bouldin Index: </span><span class="si">{</span><span class="n">db_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Create a linkage matrix for dendrogram</span>
<span class="n">linkage_matrix</span> <span class="o">=</span> <span class="n">linkage</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">)</span>

<span class="c1"># Plot the dendrogram</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_matrix</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">distance_sort</span><span class="o">=</span><span class="s1">&#39;descending&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Dendrogram&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Davies-Bouldin Index: 0.5357343073560251
</pre></div>
</div>
<img alt="../_images/b82cf20b1fe2685b3bb14ecfa47c57edb09ccc3eeaef8bdf122311831d8222e9.png" src="../_images/b82cf20b1fe2685b3bb14ecfa47c57edb09ccc3eeaef8bdf122311831d8222e9.png" />
</div>
</div>
</section>
<section id="implementation-2">
<h3>Implementation 2<a class="headerlink" href="#implementation-2" title="Permalink to this heading">#</a></h3>
<p>The code performs Gaussian Mixture Model (GMM) clustering on a synthetic dataset generated using scikit-learn’s make_blobs function. It also calculates the Davies-Bouldin Index (DBI) to evaluate the clustering results and plots a scatter plot to visualize the clustering results.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">davies_bouldin_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Generate a synthetic dataset with blobs</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n_clusters</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">data</span><span class="p">,</span> <span class="n">ground_truth_labels</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>

<span class="c1"># Perform Gaussian Mixture Model (GMM) clustering</span>
<span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="n">n_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Get the cluster labels</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Calculate Davies-Bouldin Index</span>
<span class="n">db_index</span> <span class="o">=</span> <span class="n">davies_bouldin_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Davies-Bouldin Index: </span><span class="si">{</span><span class="n">db_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot the clustering results in a scatter plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Scatter plot the data points with different colors for each cluster</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
	<span class="n">cluster_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
	<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cluster_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">cluster_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Cluster </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Feature 1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Feature 2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gaussian Mixture Model Clustering Results&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Davies-Bouldin Index: 0.21231599538998416
</pre></div>
</div>
<img alt="../_images/194d6b0e75ec5c181f1bdd0b4856da1da7e4b0c5df06905acbfea7669fd089ce.png" src="../_images/194d6b0e75ec5c181f1bdd0b4856da1da7e4b0c5df06905acbfea7669fd089ce.png" />
</div>
</div>
</section>
<section id="question">
<h3>Question<a class="headerlink" href="#question" title="Permalink to this heading">#</a></h3>
<p>Test your understanding of clustering evaluation metrics by identifying the key parameter assessed by the Davies-Bouldin Index for gauging the quality of clustering models.</p>
<div style="display:none" id="q_non_spherical_clusters">W3sicXVlc3Rpb24iOiAiV2hhdCBkb2VzIHRoZSBEYXZpZXMtQm91bGRpbiBJbmRleCBtZWFzdXJlIHdoZW4gZXZhbHVhdGluZyBjbHVzdGVyaW5nIG1vZGVscz8iLCAidHlwZSI6ICJtYW55X2Nob2ljZSIsICJhbnN3ZXJzIjogW3siYW5zd2VyIjogIlRoZSBhdmVyYWdlIGRpc3RhbmNlIGJldHdlZW4gZGF0YSBwb2ludHMgaW4gZWFjaCBjbHVzdGVyLiIsICJjb3JyZWN0IjogZmFsc2UsICJmZWVkYmFjayI6ICJJbmNvcnJlY3QuIFRoaXMgbWVhc3VyZSBmb2N1c2VzIG9uIGEgZGlmZmVyZW50IGFzcGVjdCBvZiBjbHVzdGVyaW5nIHF1YWxpdHkuIn0sIHsiYW5zd2VyIjogIlRoZSByYXRpbyBiZXR3ZWVuIGludGVyLWNsdXN0ZXIgYW5kIGludHJhLWNsdXN0ZXIgZGlzdGFuY2VzLiIsICJjb3JyZWN0IjogdHJ1ZSwgImZlZWRiYWNrIjogIkNvcnJlY3QhIFRoZSBEYXZpZXMtQm91bGRpbiBJbmRleCB1c2VzIHRoaXMgcmF0aW8gdG8gYXNzZXNzIGNsdXN0ZXJpbmcgcXVhbGl0eS4ifSwgeyJhbnN3ZXIiOiAiVGhlIHRvdGFsIG51bWJlciBvZiBjbHVzdGVycyBpbiB0aGUgZGF0YXNldC4iLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0LiBUaGUgRGF2aWVzLUJvdWxkaW4gSW5kZXggZG9lcyBub3QgZGlyZWN0bHkgbWVhc3VyZSB0aGUgdG90YWwgbnVtYmVyIG9mIGNsdXN0ZXJzLiJ9LCB7ImFuc3dlciI6ICJUaGUgZGVuc2l0eSBvZiBkYXRhIHBvaW50cyBpbiBlYWNoIGNsdXN0ZXIuIiwgImNvcnJlY3QiOiBmYWxzZSwgImZlZWRiYWNrIjogIkluY29ycmVjdC4gVGhpcyBhc3BlY3QgaXMgbm90IHRoZSBwcmltYXJ5IGZvY3VzIG9mIHRoZSBEYXZpZXMtQm91bGRpbiBJbmRleC4ifV19XQ==</div><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="lSbRijcwHpUn" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#lSbRijcwHpUn {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_non_spherical_clusters");
            var questionslSbRijcwHpUn;
            try {
               questionslSbRijcwHpUn=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionslSbRijcwHpUn = JSON.parse(element.innerHTML);
            }
            console.log(questionslSbRijcwHpUn);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("lSbRijcwHpUn")) {
            show_questions(questionslSbRijcwHpUn,  lSbRijcwHpUn); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("lSbRijcwHpUn");
        // console.log(document.getElementById("lSbRijcwHpUn"));

        try_show();
        }
        </script></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="adjusted-rand-index-ari">
<h1>Adjusted Rand Index (ARI)<a class="headerlink" href="#adjusted-rand-index-ari" title="Permalink to this heading">#</a></h1>
<p>The Adjusted Rand Index (ARI) is a measure used in clustering and classification tasks to assess the similarity between two data partitions, taking into account chance agreement. It is an adjustment of the Rand Index and provides a normalized score that considers random clustering.</p>
<p>The formula for Adjusted Rand Index is expressed as follows:</p>
<div class="math notranslate nohighlight">
\[
ARI = \frac{\text{RI} - \text{Expected}}{\text{Max} - \text{Expected}}
\]</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Explanation!</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\text{RI} &amp; = \text{Rand Index} \\
\text{Expected} &amp; = \text{Expected Rand Index under independence} \\
\text{Max} &amp; = \text{Maximum possible Rand Index}
\end{aligned}
\end{split}\]</div>
</div>
<p>The Rand Index is calculated using the formula:</p>
<div class="math notranslate nohighlight">
\[
RI = \frac{a + b}{a + b + c + d}
\]</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Explanation!</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
a &amp; = \text{Number of pairs of elements that are in the same cluster in both partitions} \\
b &amp; = \text{Number of pairs of elements that are in different clusters in both partitions} \\
c &amp; = \text{Number of pairs of elements that are in the same cluster in the first partition and in different clusters in the second partition} \\
d &amp; = \text{Number of pairs of elements that are in different clusters in the first partition and in the same cluster in the second partition}
\end{aligned}
\end{split}\]</div>
</div>
<section id="example-digits-dataset">
<h2>Example: Digits Dataset<a class="headerlink" href="#example-digits-dataset" title="Permalink to this heading">#</a></h2>
<p>Dataset looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="c1"># Load the digits dataset</span>
<span class="n">digits</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_digits</span><span class="p">()</span>

<span class="c1"># Display a few images and their labels</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># Corrected loop range</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray_r</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Label: </span><span class="si">{</span><span class="n">digits</span><span class="o">.</span><span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/47a3123a11f868c0dc65f9c6b5e8fcc2e606521ff9d40ad9456c1fb07030793b.png" src="../_images/47a3123a11f868c0dc65f9c6b5e8fcc2e606521ff9d40ad9456c1fb07030793b.png" />
</div>
</div>
<p>Assume we are using KMeans clustering algorithm with 10 clusters (digits 0-9):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculate Adjusted Rand Index:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ari_score</span> <span class="o">=</span> <span class="n">adjusted_rand_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">adjusted_rand_score</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">show</span>
<span class="kn">from</span> <span class="nn">bokeh.models</span> <span class="kn">import</span> <span class="n">ColumnDataSource</span><span class="p">,</span> <span class="n">HoverTool</span>
<span class="kn">from</span> <span class="nn">bokeh.palettes</span> <span class="kn">import</span> <span class="n">Category10_10</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_notebook</span>

<span class="c1"># Load the digits dataset</span>
<span class="n">digits</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_digits</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">data</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">target</span>

<span class="c1"># Reduce dimensionality for visualization (using PCA)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">data_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Perform K-means clustering</span>
<span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Calculate Adjusted Rand Index (ARI)</span>
<span class="n">ari</span> <span class="o">=</span> <span class="n">adjusted_rand_score</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">clusters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adjusted Rand Index (ARI): </span><span class="si">{</span><span class="n">ari</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Create a Bokeh figure</span>
<span class="n">output_notebook</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Interactive Clustering of Digits Dataset</span><span class="se">\n</span><span class="s2">ARI: </span><span class="si">{</span><span class="n">ari</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="c1"># Map cluster labels to colors</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">Category10_10</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">clusters</span><span class="p">]</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">ColumnDataSource</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">data_pca</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">data_pca</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">digit</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">cluster</span><span class="o">=</span><span class="n">clusters</span><span class="p">))</span>

<span class="c1"># Add glyphs to the plot</span>
<span class="n">scatter</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">legend_field</span><span class="o">=</span><span class="s1">&#39;digit&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="n">source</span><span class="p">,</span> <span class="n">fill_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">line_alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="c1"># Customize plot aesthetics</span>
<span class="n">p</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">text_font_size</span> <span class="o">=</span> <span class="s1">&#39;16pt&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Digit&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">label_text_font_size</span> <span class="o">=</span> <span class="s1">&#39;10pt&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s1">&#39;Principal Component 1&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">axis_label</span> <span class="o">=</span> <span class="s1">&#39;Principal Component 2&#39;</span>

<span class="c1"># Add tooltips with images</span>
<span class="n">hover</span> <span class="o">=</span> <span class="n">HoverTool</span><span class="p">()</span>
<span class="n">hover</span><span class="o">.</span><span class="n">tooltips</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Digit&quot;</span><span class="p">,</span> <span class="s2">&quot;@digit&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Cluster&quot;</span><span class="p">,</span> <span class="s2">&quot;@cluster&quot;</span><span class="p">)]</span>
<span class="n">hover</span><span class="o">.</span><span class="n">renderers</span> <span class="o">=</span> <span class="p">[</span><span class="n">scatter</span><span class="p">]</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_tools</span><span class="p">(</span><span class="n">hover</span><span class="p">)</span>

<span class="c1"># Show the interactive plot</span>
<span class="n">show</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Adjusted Rand Index (ARI): 0.6669121092859385
</pre></div>
</div>
<div class="output text_html">    <style>
        .bk-notebook-logo {
            display: block;
            width: 20px;
            height: 20px;
            background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
        }
    </style>
    <div>
        <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
        <span id="eef24d1d-72be-40cc-8dd8-206c2a6430dd">Loading BokehJS ...</span>
    </div>
</div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    function drop(id) {
      const view = Bokeh.index.get_by_id(id)
      if (view != null) {
        view.model.document.clear()
        Bokeh.index.delete(view)
      }
    }

    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;

    // Clean up Bokeh references
    if (id != null) {
      drop(id)
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim()
            drop(id)
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    const el = document.getElementById("eef24d1d-72be-40cc-8dd8-206c2a6430dd");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.3.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.3.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.3.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.3.2.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.3.2.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
          for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("eef24d1d-72be-40cc-8dd8-206c2a6430dd")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><div class="output text_html">
  <div id="b69d7d11-9570-46f6-9d4d-e5e1fbaadde4" data-root-id="p1001" style="display: contents;"></div>
</div><script type="application/javascript">(function(root) {
  function embed_document(root) {
  const docs_json = {"c59c7d52-4b71-401c-bf71-6f1d84221d2a":{"version":"3.3.2","title":"Bokeh Application","roots":[{"type":"object","name":"Figure","id":"p1001","attributes":{"width":800,"x_range":{"type":"object","name":"DataRange1d","id":"p1002"},"y_range":{"type":"object","name":"DataRange1d","id":"p1003"},"x_scale":{"type":"object","name":"LinearScale","id":"p1011"},"y_scale":{"type":"object","name":"LinearScale","id":"p1012"},"title":{"type":"object","name":"Title","id":"p1004","attributes":{"text":"Interactive Clustering of Digits Dataset\nARI: 0.6669","text_font_size":"16pt"}},"renderers":[{"type":"object","name":"GlyphRenderer","id":"p1043","attributes":{"data_source":{"type":"object","name":"ColumnDataSource","id":"p1034","attributes":{"selected":{"type":"object","name":"Selection","id":"p1035","attributes":{"indices":[],"line_indices":[]}},"selection_policy":{"type":"object","name":"UnionRenderers","id":"p1036"},"data":{"type":"map","entries":[["x",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[1797],"dtype":"float64","order":"little"}],["y",{"type":"ndarray","array":{"type":"bytes","data":"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"},"shape":[1797],"dtype":"float64","order":"little"}],["color",["#ff7f0e","#d62728","#d62728","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#2ca02c","#d62728","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#d62728","#bcbd22","#d62728","#17becf","#2ca02c","#9467bd","#9467bd","#e377c2","#7f7f7f","#2ca02c","#ff7f0e","#ff7f0e","#d62728","#d62728","#9467bd","#d62728","#9467bd","#ff7f0e","#2ca02c","#d62728","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#d62728","#2ca02c","#7f7f7f","#ff7f0e","#bcbd22","#7f7f7f","#2ca02c","#d62728","#2ca02c","#ff7f0e","#ff7f0e","#2ca02c","#9467bd","#8c564b","#e377c2","#1f77b4","#2ca02c","#9467bd","#17becf","#8c564b","#e377c2","#2ca02c","#e377c2","#e377c2","#d62728","#9467bd","#d62728","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#7f7f7f","#9467bd","#8c564b","#bcbd22","#8c564b","#2ca02c","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#d62728","#d62728","#d62728","#7f7f7f","#9467bd","#bcbd22","#7f7f7f","#17becf","#d62728","#d62728","#17becf","#bcbd22","#ff7f0e","#d62728","#bcbd22","#d62728","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#e377c2","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#d62728","#bcbd22","#d62728","#17becf","#2ca02c","#9467bd","#9467bd","#e377c2","#7f7f7f","#2ca02c","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#d62728","#1f77b4","#ff7f0e","#2ca02c","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#d62728","#bcbd22","#2ca02c","#7f7f7f","#ff7f0e","#bcbd22","#7f7f7f","#1f77b4","#d62728","#1f77b4","#ff7f0e","#ff7f0e","#2ca02c","#9467bd","#8c564b","#e377c2","#1f77b4","#2ca02c","#9467bd","#e377c2","#2ca02c","#e377c2","#bcbd22","#2ca02c","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#2ca02c","#17becf","#ff7f0e","#7f7f7f","#9467bd","#8c564b","#bcbd22","#8c564b","#2ca02c","#9467bd","#7f7f7f","#d62728","#17becf","#9467bd","#1f77b4","#d62728","#1f77b4","#1f77b4","#7f7f7f","#7f7f7f","#2ca02c","#d62728","#d62728","#17becf","#bcbd22","#ff7f0e","#d62728","#bcbd22","#d62728","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#bcbd22","#7f7f7f","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#9467bd","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#bcbd22","#8c564b","#bcbd22","#ff7f0e","#bcbd22","#d62728","#bcbd22","#d62728","#17becf","#d62728","#9467bd","#9467bd","#e377c2","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#bcbd22","#1f77b4","#ff7f0e","#2ca02c","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#9467bd","#d62728","#7f7f7f","#ff7f0e","#9467bd","#7f7f7f","#1f77b4","#bcbd22","#1f77b4","#ff7f0e","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#e377c2","#9467bd","#d62728","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#bcbd22","#e377c2","#8c564b","#9467bd","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#bcbd22","#1f77b4","#1f77b4","#bcbd22","#9467bd","#2ca02c","#7f7f7f","#17becf","#bcbd22","#bcbd22","#17becf","#2ca02c","#ff7f0e","#d62728","#9467bd","#e377c2","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#7f7f7f","#bcbd22","#bcbd22","#ff7f0e","#bcbd22","#e377c2","#7f7f7f","#8c564b","#e377c2","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#bcbd22","#17becf","#2ca02c","#9467bd","#9467bd","#e377c2","#7f7f7f","#2ca02c","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#bcbd22","#1f77b4","#ff7f0e","#1f77b4","#1f77b4","#8c564b","#e377c2","#bcbd22","#7f7f7f","#bcbd22","#bcbd22","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#2ca02c","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#1f77b4","#d62728","#1f77b4","#ff7f0e","#ff7f0e","#2ca02c","#7f7f7f","#8c564b","#e377c2","#1f77b4","#2ca02c","#9467bd","#17becf","#8c564b","#e377c2","#2ca02c","#e377c2","#bcbd22","#2ca02c","#7f7f7f","#8c564b","#bcbd22","#17becf","#e377c2","#2ca02c","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#bcbd22","#d62728","#2ca02c","#9467bd","#7f7f7f","#2ca02c","#17becf","#7f7f7f","#1f77b4","#bcbd22","#1f77b4","#d62728","#7f7f7f","#9467bd","#bcbd22","#7f7f7f","#17becf","#d62728","#d62728","#17becf","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#ff7f0e","#1f77b4","#1f77b4","#bcbd22","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#1f77b4","#1f77b4","#bcbd22","#9467bd","#bcbd22","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#1f77b4","#1f77b4","#1f77b4","#17becf","#bcbd22","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#d62728","#7f7f7f","#bcbd22","#8c564b","#bcbd22","#ff7f0e","#bcbd22","#d62728","#bcbd22","#d62728","#17becf","#1f77b4","#9467bd","#9467bd","#e377c2","#bcbd22","#8c564b","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#8c564b","#1f77b4","#ff7f0e","#1f77b4","#1f77b4","#8c564b","#bcbd22","#e377c2","#9467bd","#bcbd22","#bcbd22","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#bcbd22","#1f77b4","#d62728","#1f77b4","#ff7f0e","#ff7f0e","#1f77b4","#9467bd","#8c564b","#bcbd22","#1f77b4","#1f77b4","#9467bd","#17becf","#8c564b","#e377c2","#1f77b4","#bcbd22","#bcbd22","#1f77b4","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#bcbd22","#e377c2","#8c564b","#bcbd22","#8c564b","#1f77b4","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#d62728","#1f77b4","#1f77b4","#7f7f7f","#9467bd","#bcbd22","#bcbd22","#9467bd","#2ca02c","#d62728","#9467bd","#bcbd22","#ff7f0e","#d62728","#bcbd22","#d62728","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#bcbd22","#2ca02c","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#2ca02c","#ff7f0e","#d62728","#1f77b4","#e377c2","#2ca02c","#7f7f7f","#8c564b","#9467bd","#bcbd22","#2ca02c","#ff7f0e","#2ca02c","#17becf","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#2ca02c","#d62728","#2ca02c","#bcbd22","#17becf","#d62728","#9467bd","#2ca02c","#e377c2","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#e377c2","#1f77b4","#9467bd","#d62728","#d62728","#ff7f0e","#d62728","#bcbd22","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#2ca02c","#d62728","#7f7f7f","#ff7f0e","#2ca02c","#7f7f7f","#e377c2","#bcbd22","#1f77b4","#ff7f0e","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#e377c2","#2ca02c","#d62728","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#9467bd","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#2ca02c","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#9467bd","#9467bd","#1f77b4","#d62728","#1f77b4","#1f77b4","#7f7f7f","#9467bd","#2ca02c","#7f7f7f","#17becf","#bcbd22","#d62728","#9467bd","#2ca02c","#ff7f0e","#bcbd22","#2ca02c","#d62728","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#8c564b","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#ff7f0e","#9467bd","#2ca02c","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#bcbd22","#17becf","#d62728","#9467bd","#9467bd","#e377c2","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#2ca02c","#1f77b4","#ff7f0e","#1f77b4","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#d62728","#7f7f7f","#ff7f0e","#bcbd22","#7f7f7f","#1f77b4","#d62728","#1f77b4","#ff7f0e","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#9467bd","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#e377c2","#bcbd22","#d62728","#9467bd","#8c564b","#1f77b4","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#bcbd22","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#2ca02c","#9467bd","#1f77b4","#7f7f7f","#9467bd","#bcbd22","#7f7f7f","#17becf","#2ca02c","#bcbd22","#17becf","#bcbd22","#ff7f0e","#d62728","#bcbd22","#d62728","#1f77b4","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#1f77b4","#1f77b4","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#1f77b4","#1f77b4","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#8c564b","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#d62728","#17becf","#e377c2","#9467bd","#9467bd","#e377c2","#bcbd22","#1f77b4","#1f77b4","#9467bd","#bcbd22","#1f77b4","#ff7f0e","#1f77b4","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#1f77b4","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#1f77b4","#bcbd22","#1f77b4","#ff7f0e","#ff7f0e","#1f77b4","#9467bd","#8c564b","#e377c2","#1f77b4","#1f77b4","#17becf","#8c564b","#e377c2","#1f77b4","#e377c2","#bcbd22","#1f77b4","#9467bd","#8c564b","#bcbd22","#17becf","#e377c2","#1f77b4","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#bcbd22","#8c564b","#1f77b4","#9467bd","#bcbd22","#17becf","#17becf","#9467bd","#1f77b4","#bcbd22","#1f77b4","#1f77b4","#bcbd22","#9467bd","#bcbd22","#bcbd22","#17becf","#17becf","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#9467bd","#e377c2","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#d62728","#17becf","#d62728","#9467bd","#9467bd","#e377c2","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#9467bd","#d62728","#1f77b4","#ff7f0e","#d62728","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#9467bd","#bcbd22","#d62728","#7f7f7f","#ff7f0e","#7f7f7f","#7f7f7f","#1f77b4","#e377c2","#e377c2","#ff7f0e","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#9467bd","#bcbd22","#d62728","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#bcbd22","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#d62728","#1f77b4","#1f77b4","#7f7f7f","#9467bd","#bcbd22","#7f7f7f","#17becf","#1f77b4","#e377c2","#17becf","#bcbd22","#ff7f0e","#d62728","#bcbd22","#d62728","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#e377c2","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#7f7f7f","#bcbd22","#7f7f7f","#17becf","#d62728","#9467bd","#9467bd","#9467bd","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#9467bd","#1f77b4","#ff7f0e","#d62728","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#d62728","#7f7f7f","#ff7f0e","#bcbd22","#7f7f7f","#1f77b4","#7f7f7f","#1f77b4","#ff7f0e","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#e377c2","#bcbd22","#d62728","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#bcbd22","#8c564b","#7f7f7f","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#1f77b4","#1f77b4","#1f77b4","#7f7f7f","#9467bd","#bcbd22","#7f7f7f","#17becf","#d62728","#d62728","#17becf","#bcbd22","#ff7f0e","#d62728","#bcbd22","#d62728","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#2ca02c","#e377c2","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#d62728","#bcbd22","#d62728","#17becf","#d62728","#9467bd","#9467bd","#e377c2","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#e377c2","#e377c2","#9467bd","#d62728","#e377c2","#ff7f0e","#2ca02c","#e377c2","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#d62728","#7f7f7f","#ff7f0e","#bcbd22","#8c564b","#1f77b4","#d62728","#e377c2","#ff7f0e","#ff7f0e","#2ca02c","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#e377c2","#bcbd22","#d62728","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#bcbd22","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#bcbd22","#d62728","#1f77b4","#1f77b4","#bcbd22","#9467bd","#bcbd22","#7f7f7f","#17becf","#d62728","#d62728","#17becf","#bcbd22","#ff7f0e","#d62728","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#2ca02c","#1f77b4","#e377c2","#17becf","#bcbd22","#8c564b","#9467bd","#bcbd22","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#8c564b","#bcbd22","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#bcbd22","#17becf","#2ca02c","#9467bd","#9467bd","#e377c2","#bcbd22","#2ca02c","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#2ca02c","#1f77b4","#ff7f0e","#2ca02c","#1f77b4","#8c564b","#e377c2","#e377c2","#9467bd","#e377c2","#e377c2","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#2ca02c","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#1f77b4","#bcbd22","#1f77b4","#ff7f0e","#ff7f0e","#2ca02c","#9467bd","#8c564b","#e377c2","#1f77b4","#2ca02c","#9467bd","#17becf","#8c564b","#e377c2","#2ca02c","#e377c2","#bcbd22","#2ca02c","#9467bd","#8c564b","#bcbd22","#17becf","#e377c2","#2ca02c","#17becf","#ff7f0e","#bcbd22","#e377c2","#8c564b","#bcbd22","#8c564b","#2ca02c","#9467bd","#bcbd22","#17becf","#17becf","#9467bd","#1f77b4","#bcbd22","#1f77b4","#1f77b4","#7f7f7f","#9467bd","#bcbd22","#7f7f7f","#17becf","#bcbd22","#7f7f7f","#17becf","#e377c2","#ff7f0e","#7f7f7f","#bcbd22","#bcbd22","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#2ca02c","#d62728","#d62728","#2ca02c","#ff7f0e","#d62728","#e377c2","#e377c2","#17becf","#7f7f7f","#8c564b","#2ca02c","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#7f7f7f","#2ca02c","#17becf","#2ca02c","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#7f7f7f","#d62728","#7f7f7f","#d62728","#17becf","#d62728","#9467bd","#9467bd","#d62728","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#ff7f0e","#1f77b4","#d62728","#d62728","#e377c2","#ff7f0e","#d62728","#1f77b4","#8c564b","#d62728","#9467bd","#9467bd","#9467bd","#d62728","#17becf","#8c564b","#8c564b","#8c564b","#d62728","#2ca02c","#d62728","#7f7f7f","#ff7f0e","#bcbd22","#7f7f7f","#e377c2","#d62728","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#d62728","#8c564b","#e377c2","#d62728","#e377c2","#9467bd","#d62728","#9467bd","#8c564b","#d62728","#17becf","#e377c2","#d62728","#17becf","#ff7f0e","#7f7f7f","#e377c2","#8c564b","#e377c2","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#e377c2","#7f7f7f","#9467bd","#e377c2","#7f7f7f","#9467bd","#17becf","#7f7f7f","#ff7f0e","#d62728","#7f7f7f","#9467bd","#ff7f0e","#d62728","#1f77b4","#e377c2","#17becf","#7f7f7f","#8c564b","#9467bd","#e377c2","#bcbd22","#ff7f0e","#d62728","#1f77b4","#d62728","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#d62728","#1f77b4","#7f7f7f","#17becf","#7f7f7f","#8c564b","#9467bd","#d62728","#bcbd22","#ff7f0e","#bcbd22","#7f7f7f","#7f7f7f","#8c564b","#7f7f7f","#ff7f0e","#bcbd22","#bcbd22","#bcbd22","#d62728","#17becf","#d62728","#9467bd","#9467bd","#9467bd","#7f7f7f","#d62728","#ff7f0e","#ff7f0e","#1f77b4","#1f77b4","#9467bd","#d62728","#1f77b4","#ff7f0e","#d62728","#1f77b4","#8c564b","#d62728","#d62728","#9467bd","#bcbd22","#d62728","#17becf","#8c564b","#8c564b","#8c564b","#17becf","#bcbd22","#d62728","#7f7f7f","#ff7f0e","#bcbd22","#bcbd22","#1f77b4","#d62728","#1f77b4","#ff7f0e","#ff7f0e","#d62728","#9467bd","#8c564b","#e377c2","#1f77b4","#d62728","#9467bd","#17becf","#8c564b","#e377c2","#d62728","#e377c2","#bcbd22","#d62728","#9467bd","#8c564b","#d62728","#17becf","#7f7f7f","#d62728","#17becf","#ff7f0e","#bcbd22","#e377c2","#8c564b","#bcbd22","#8c564b","#d62728","#9467bd","#7f7f7f","#17becf","#17becf","#9467bd","#1f77b4","#d62728","#1f77b4","#1f77b4","#bcbd22","#9467bd","#bcbd22","#bcbd22","#17becf","#d62728","#d62728","#17becf","#bcbd22","#ff7f0e","#d62728","#bcbd22","#bcbd22"]],["digit",{"type":"ndarray","array":{"type":"bytes","data":"AAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAkAAAAFAAAABQAAAAYAAAAFAAAAAAAAAAkAAAAIAAAACQAAAAgAAAAEAAAAAQAAAAcAAAAHAAAAAwAAAAUAAAABAAAAAAAAAAAAAAACAAAAAgAAAAcAAAAIAAAAAgAAAAAAAAABAAAAAgAAAAYAAAADAAAAAwAAAAcAAAADAAAAAwAAAAQAAAAGAAAABgAAAAYAAAAEAAAACQAAAAEAAAAFAAAAAAAAAAkAAAAFAAAAAgAAAAgAAAACAAAAAAAAAAAAAAABAAAABwAAAAYAAAADAAAAAgAAAAEAAAAHAAAABAAAAAYAAAADAAAAAQAAAAMAAAAJAAAAAQAAAAcAAAAGAAAACAAAAAQAAAADAAAAAQAAAAQAAAAAAAAABQAAAAMAAAAGAAAACQAAAAYAAAABAAAABwAAAAUAAAAEAAAABAAAAAcAAAACAAAACAAAAAIAAAACAAAABQAAAAcAAAAJAAAABQAAAAQAAAAIAAAACAAAAAQAAAAJAAAAAAAAAAgAAAAJAAAACAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAAJAAAABQAAAAUAAAAGAAAABQAAAAAAAAAJAAAACAAAAAkAAAAIAAAABAAAAAEAAAAHAAAABwAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAgAAAAIAAAAHAAAACAAAAAIAAAAAAAAAAQAAAAIAAAAGAAAAAwAAAAMAAAAHAAAAAwAAAAMAAAAEAAAABgAAAAYAAAAGAAAABAAAAAkAAAABAAAABQAAAAAAAAAJAAAABQAAAAIAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAAcAAAAGAAAAAwAAAAIAAAABAAAABwAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAAIAAAAAgAAAAIAAAAFAAAABQAAAAQAAAAIAAAACAAAAAQAAAAJAAAAAAAAAAgAAAAJAAAACAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAAJAAAABQAAAAUAAAAGAAAABQAAAAAAAAAJAAAACAAAAAkAAAAIAAAABAAAAAEAAAAHAAAABwAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAgAAAAIAAAAHAAAACAAAAAIAAAAAAAAAAQAAAAIAAAAGAAAAAwAAAAMAAAAHAAAAAwAAAAMAAAAEAAAABgAAAAYAAAAGAAAABAAAAAkAAAABAAAABQAAAAAAAAAJAAAABQAAAAIAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAAcAAAAGAAAAAwAAAAIAAAABAAAABwAAAAQAAAAGAAAAAwAAAAEAAAADAAAACQAAAAEAAAAHAAAABgAAAAgAAAAEAAAAAwAAAAEAAAAEAAAAAAAAAAUAAAADAAAABgAAAAkAAAAGAAAAAQAAAAcAAAAFAAAABAAAAAQAAAAHAAAAAgAAAAgAAAACAAAAAgAAAAUAAAAHAAAACQAAAAUAAAAEAAAACAAAAAgAAAAEAAAACQAAAAAAAAAIAAAACQAAAAMAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAACQAAAAUAAAAFAAAABgAAAAUAAAAAAAAACQAAAAgAAAAJAAAACAAAAAQAAAABAAAABwAAAAcAAAADAAAABQAAAAEAAAAAAAAAAAAAAAIAAAACAAAABwAAAAgAAAACAAAAAAAAAAEAAAACAAAABgAAAAMAAAADAAAABwAAAAMAAAADAAAABAAAAAYAAAAGAAAABgAAAAQAAAAJAAAAAQAAAAUAAAAAAAAACQAAAAUAAAACAAAACAAAAAIAAAAAAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAcAAAAEAAAABgAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAAIAAAAAgAAAAIAAAAFAAAABwAAAAkAAAAFAAAABAAAAAgAAAAIAAAABAAAAAkAAAAAAAAACAAAAAkAAAAIAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAkAAAAFAAAABQAAAAYAAAAFAAAAAAAAAAkAAAAIAAAACQAAAAgAAAAEAAAAAQAAAAcAAAAHAAAAAwAAAAUAAAABAAAAAAAAAAAAAAACAAAAAgAAAAcAAAAIAAAAAgAAAAAAAAABAAAAAgAAAAYAAAADAAAAAwAAAAcAAAADAAAAAwAAAAQAAAAGAAAABgAAAAYAAAAEAAAACQAAAAEAAAAFAAAAAAAAAAkAAAAFAAAAAgAAAAgAAAACAAAAAAAAAAAAAAABAAAABwAAAAYAAAADAAAAAgAAAAEAAAAHAAAABAAAAAYAAAADAAAAAQAAAAMAAAAJAAAAAQAAAAcAAAAGAAAACAAAAAQAAAADAAAAAQAAAAQAAAAAAAAABQAAAAMAAAAGAAAACQAAAAYAAAABAAAABwAAAAUAAAAEAAAABAAAAAcAAAACAAAACAAAAAIAAAACAAAABQAAAAcAAAAJAAAABQAAAAQAAAAIAAAACAAAAAQAAAAJAAAAAAAAAAgAAAAJAAAACAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAAJAAAABQAAAAUAAAAGAAAABQAAAAAAAAAJAAAACAAAAAkAAAAIAAAABAAAAAEAAAAHAAAABwAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAgAAAAIAAAAHAAAACAAAAAIAAAAAAAAAAQAAAAIAAAAGAAAAAwAAAAMAAAAHAAAAAwAAAAMAAAAEAAAABgAAAAYAAAAGAAAABAAAAAkAAAABAAAABQAAAAAAAAAJAAAABQAAAAIAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAAcAAAAGAAAAAwAAAAIAAAABAAAABwAAAAQAAAAGAAAAAwAAAAEAAAADAAAACQAAAAEAAAAHAAAABgAAAAgAAAAEAAAAAwAAAAEAAAAEAAAAAAAAAAUAAAADAAAABgAAAAkAAAAGAAAAAQAAAAcAAAAFAAAABAAAAAQAAAAHAAAAAgAAAAgAAAACAAAAAgAAAAUAAAAHAAAACQAAAAUAAAAEAAAACAAAAAgAAAAEAAAACQAAAAAAAAAIAAAACQAAAAgAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAACQAAAAUAAAAFAAAABgAAAAUAAAAAAAAACQAAAAgAAAAJAAAACAAAAAQAAAABAAAABwAAAAcAAAADAAAABQAAAAEAAAAAAAAAAAAAAAIAAAACAAAABwAAAAgAAAACAAAAAAAAAAEAAAACAAAABgAAAAMAAAADAAAABwAAAAMAAAADAAAABAAAAAYAAAAGAAAABgAAAAQAAAAJAAAAAQAAAAUAAAAAAAAACQAAAAUAAAACAAAACAAAAAIAAAAAAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAcAAAAEAAAABgAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAAIAAAAAgAAAAIAAAAFAAAABwAAAAkAAAAFAAAABAAAAAgAAAAIAAAABAAAAAkAAAAAAAAACAAAAAkAAAAIAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAACQAAAAUAAAAFAAAABgAAAAUAAAAAAAAACQAAAAgAAAAJAAAACAAAAAQAAAABAAAABwAAAAcAAAADAAAABQAAAAEAAAACAAAABwAAAAgAAAACAAAAAAAAAAEAAAACAAAABgAAAAMAAAADAAAABwAAAAMAAAADAAAABAAAAAYAAAAGAAAABgAAAAQAAAAJAAAAAQAAAAUAAAAAAAAACQAAAAUAAAACAAAACAAAAAIAAAAAAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAQAAAAGAAAAAwAAAAEAAAADAAAACQAAAAEAAAAHAAAABgAAAAgAAAAEAAAAAwAAAAEAAAAEAAAAAAAAAAUAAAADAAAABgAAAAkAAAAGAAAAAQAAAAcAAAAFAAAABAAAAAQAAAAHAAAAAgAAAAgAAAACAAAAAgAAAAUAAAAHAAAACQAAAAUAAAAEAAAABAAAAAkAAAAAAAAACAAAAAkAAAAIAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAkAAAAFAAAABQAAAAYAAAAFAAAAAAAAAAkAAAAIAAAACQAAAAgAAAAEAAAAAQAAAAcAAAAHAAAAAwAAAAUAAAABAAAAAAAAAAAAAAAHAAAACAAAAAIAAAAAAAAAAQAAAAIAAAAGAAAAAwAAAAMAAAAHAAAAAwAAAAMAAAAEAAAABgAAAAYAAAAGAAAABAAAAAkAAAABAAAABQAAAAAAAAAJAAAABQAAAAIAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAAcAAAAGAAAAAwAAAAIAAAABAAAABwAAAAQAAAAGAAAAAwAAAAEAAAADAAAACQAAAAEAAAAHAAAABgAAAAgAAAAEAAAAAwAAAAEAAAAEAAAAAAAAAAUAAAADAAAABgAAAAkAAAAGAAAAAQAAAAcAAAAFAAAABAAAAAQAAAAHAAAAAgAAAAgAAAACAAAAAgAAAAUAAAAHAAAACQAAAAUAAAAEAAAACAAAAAgAAAAEAAAACQAAAAAAAAAIAAAACQAAAAgAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAACQAAAAUAAAAFAAAABgAAAAUAAAAAAAAACQAAAAgAAAAJAAAACAAAAAQAAAABAAAABwAAAAcAAAADAAAABQAAAAEAAAAAAAAAAAAAAAIAAAACAAAABwAAAAgAAAACAAAAAAAAAAEAAAACAAAABgAAAAMAAAADAAAABwAAAAMAAAADAAAABAAAAAYAAAAGAAAABgAAAAQAAAAJAAAAAQAAAAUAAAAAAAAACQAAAAUAAAACAAAACAAAAAIAAAAAAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAcAAAAEAAAABgAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAAIAAAAAgAAAAIAAAAFAAAABwAAAAkAAAAFAAAABAAAAAgAAAAIAAAABAAAAAkAAAAAAAAACAAAAAkAAAAIAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAkAAAAFAAAABQAAAAYAAAAFAAAAAAAAAAkAAAAIAAAACQAAAAgAAAAEAAAAAQAAAAcAAAAHAAAAAwAAAAUAAAABAAAAAAAAAAAAAAACAAAAAgAAAAcAAAAIAAAAAgAAAAAAAAABAAAAAgAAAAYAAAADAAAAAwAAAAcAAAADAAAAAwAAAAQAAAAGAAAABgAAAAYAAAAEAAAACQAAAAEAAAAFAAAAAAAAAAkAAAAFAAAAAgAAAAgAAAACAAAAAAAAAAAAAAABAAAABwAAAAYAAAADAAAAAgAAAAEAAAAHAAAABAAAAAYAAAADAAAAAQAAAAMAAAAJAAAAAQAAAAcAAAAGAAAACAAAAAQAAAADAAAAAQAAAAQAAAAAAAAABQAAAAMAAAAGAAAACQAAAAYAAAABAAAABwAAAAUAAAAEAAAABAAAAAcAAAACAAAACAAAAAIAAAACAAAABQAAAAcAAAAJAAAABQAAAAQAAAAIAAAACAAAAAQAAAAJAAAAAAAAAAgAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAACQAAAAUAAAAFAAAABgAAAAUAAAAAAAAACQAAAAgAAAAJAAAACAAAAAQAAAABAAAABwAAAAcAAAADAAAABQAAAAEAAAAAAAAAAAAAAAIAAAACAAAABwAAAAgAAAACAAAAAAAAAAEAAAACAAAABgAAAAMAAAADAAAABwAAAAMAAAADAAAABAAAAAYAAAAGAAAABgAAAAQAAAAJAAAAAQAAAAUAAAAAAAAACQAAAAUAAAACAAAACAAAAAIAAAAAAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAcAAAAEAAAABgAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAAIAAAAAgAAAAIAAAAFAAAABwAAAAkAAAAFAAAABAAAAAgAAAAIAAAABAAAAAkAAAAAAAAACAAAAAkAAAAIAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAAJAAAABQAAAAUAAAAGAAAABQAAAAAAAAAJAAAACAAAAAkAAAAIAAAABAAAAAEAAAAHAAAABwAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAgAAAAIAAAAHAAAACAAAAAIAAAAAAAAAAQAAAAIAAAAGAAAAAwAAAAMAAAAHAAAAAwAAAAMAAAAEAAAABgAAAAYAAAAGAAAABAAAAAkAAAABAAAABQAAAAAAAAAJAAAABQAAAAIAAAAIAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAcAAAAEAAAABgAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAACAAAABQAAAAcAAAAJAAAABQAAAAQAAAAEAAAACQAAAAAAAAAIAAAACQAAAAgAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAABwAAAAgAAAAJAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAHAAAACAAAAAkAAAAAAAAACQAAAAUAAAAFAAAABgAAAAUAAAAAAAAACQAAAAgAAAAJAAAACAAAAAQAAAABAAAABwAAAAcAAAADAAAABQAAAAEAAAAAAAAAAAAAAAIAAAACAAAABwAAAAgAAAACAAAAAAAAAAEAAAACAAAABgAAAAMAAAADAAAABwAAAAMAAAADAAAABAAAAAYAAAAGAAAABgAAAAQAAAAJAAAAAQAAAAUAAAAAAAAACQAAAAUAAAACAAAACAAAAAIAAAAAAAAAAAAAAAEAAAAHAAAABgAAAAMAAAACAAAAAQAAAAcAAAAEAAAABgAAAAMAAAABAAAAAwAAAAkAAAABAAAABwAAAAYAAAAIAAAABAAAAAMAAAABAAAABAAAAAAAAAAFAAAAAwAAAAYAAAAJAAAABgAAAAEAAAAHAAAABQAAAAQAAAAEAAAABwAAAAIAAAAIAAAAAgAAAAIAAAAFAAAABwAAAAkAAAAFAAAABAAAAAgAAAAIAAAABAAAAAkAAAAAAAAACAAAAAkAAAAIAAAA"},"shape":[1797],"dtype":"int32","order":"little"}],["cluster",{"type":"ndarray","array":{"type":"bytes","data":"AQAAAAMAAAADAAAABgAAAAkAAAAIAAAABQAAAAQAAAADAAAACAAAAAEAAAACAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAAAgAAAAAAAAAGAAAACQAAAAcAAAAFAAAAAgAAAAMAAAAIAAAAAQAAAAgAAAAHAAAABwAAAAUAAAAHAAAAAQAAAAgAAAADAAAACAAAAAMAAAAJAAAAAgAAAAQAAAAEAAAABgAAAAcAAAACAAAAAQAAAAEAAAADAAAAAwAAAAQAAAADAAAABAAAAAEAAAACAAAAAwAAAAUAAAAGAAAABgAAAAQAAAAGAAAABgAAAAkAAAAFAAAABQAAAAUAAAAJAAAAAwAAAAIAAAAHAAAAAQAAAAgAAAAHAAAAAgAAAAMAAAACAAAAAQAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAAEAAAACQAAAAUAAAAGAAAAAgAAAAYAAAAGAAAAAwAAAAQAAAADAAAAAwAAAAkAAAAGAAAAAwAAAAkAAAABAAAABwAAAAQAAAAFAAAACAAAAAUAAAACAAAABAAAAAcAAAAJAAAACQAAAAQAAAAAAAAAAwAAAAMAAAADAAAABwAAAAQAAAAIAAAABwAAAAkAAAADAAAAAwAAAAkAAAAIAAAAAQAAAAMAAAAIAAAAAwAAAAEAAAACAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAAAgAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAMAAAAIAAAAAQAAAAIAAAAAAAAABgAAAAkAAAAHAAAABQAAAAQAAAADAAAACAAAAAEAAAAGAAAABwAAAAcAAAAFAAAABwAAAAEAAAAIAAAAAwAAAAgAAAADAAAACQAAAAIAAAAEAAAABAAAAAYAAAAHAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAEAAAAAwAAAAAAAAABAAAAAgAAAAAAAAAFAAAABgAAAAYAAAAEAAAABgAAAAYAAAAJAAAABQAAAAUAAAAFAAAAAwAAAAgAAAACAAAABwAAAAEAAAAIAAAABwAAAAAAAAADAAAAAAAAAAEAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAACAAAABAAAAAYAAAACAAAABgAAAAgAAAACAAAABAAAAAUAAAADAAAACQAAAAYAAAACAAAACQAAAAEAAAAHAAAABAAAAAUAAAAIAAAABQAAAAIAAAAEAAAABwAAAAMAAAAJAAAABAAAAAAAAAADAAAAAAAAAAAAAAAHAAAABwAAAAIAAAADAAAAAwAAAAkAAAAIAAAAAQAAAAMAAAAIAAAAAwAAAAEAAAADAAAAAAAAAAYAAAAJAAAACAAAAAUAAAAEAAAACAAAAAcAAAABAAAAAwAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAMAAAAEAAAAAQAAAAMAAAAAAAAABgAAAAkAAAAHAAAABQAAAAQAAAADAAAACAAAAAEAAAAIAAAABwAAAAgAAAAFAAAACAAAAAEAAAAIAAAAAwAAAAgAAAADAAAACQAAAAMAAAAEAAAABAAAAAYAAAAHAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAEAAAACAAAAAAAAAABAAAAAgAAAAAAAAAFAAAABgAAAAYAAAAEAAAABgAAAAYAAAAJAAAABQAAAAUAAAAFAAAACQAAAAQAAAADAAAABwAAAAEAAAAEAAAABwAAAAAAAAAIAAAAAAAAAAEAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAADAAAABAAAAAkAAAAFAAAABgAAAAMAAAAGAAAABAAAAAMAAAAEAAAABQAAAAMAAAAJAAAABgAAAAMAAAAJAAAAAQAAAAgAAAAGAAAABQAAAAQAAAAFAAAAAwAAAAQAAAAHAAAACQAAAAkAAAAEAAAAAAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAgAAAAcAAAAJAAAACAAAAAgAAAAJAAAAAgAAAAEAAAADAAAABAAAAAYAAAABAAAAAgAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAgAAAAIAAAAAQAAAAIAAAAAAAAABgAAAAkAAAAHAAAABQAAAAQAAAADAAAACAAAAAEAAAACAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAHAAAACAAAAAgAAAABAAAACAAAAAYAAAAHAAAABQAAAAYAAAABAAAACAAAAAgAAAAIAAAACAAAAAkAAAACAAAABAAAAAQAAAAGAAAABwAAAAIAAAABAAAAAQAAAAAAAAAAAAAABAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAYAAAAIAAAABwAAAAgAAAAIAAAACQAAAAUAAAAFAAAABQAAAAkAAAAIAAAAAgAAAAgAAAABAAAACAAAAAcAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAIAAAAHAAAABQAAAAYAAAAAAAAAAgAAAAQAAAAJAAAABQAAAAYAAAACAAAABgAAAAgAAAACAAAABwAAAAUAAAAIAAAACQAAAAYAAAACAAAACQAAAAEAAAAHAAAABgAAAAUAAAAIAAAAAwAAAAIAAAAEAAAABwAAAAIAAAAJAAAABwAAAAAAAAAIAAAAAAAAAAMAAAAHAAAABAAAAAgAAAAHAAAACQAAAAMAAAADAAAACQAAAAgAAAABAAAACAAAAAgAAAAIAAAAAQAAAAAAAAAAAAAACAAAAAkAAAAHAAAABQAAAAQAAAADAAAACAAAAAEAAAAAAAAAAAAAAAgAAAAEAAAACAAAAAUAAAAEAAAAAwAAAAgAAAABAAAAAAAAAAAAAAAAAAAACQAAAAgAAAAFAAAABAAAAAMAAAAIAAAAAQAAAAMAAAAHAAAACAAAAAUAAAAIAAAAAQAAAAgAAAADAAAACAAAAAMAAAAJAAAAAAAAAAQAAAAEAAAABgAAAAgAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAQAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAIAAAABgAAAAQAAAAIAAAACAAAAAkAAAAFAAAABQAAAAUAAAAJAAAACAAAAAUAAAAHAAAAAQAAAAgAAAAIAAAAAAAAAAMAAAAAAAAAAQAAAAEAAAAAAAAABAAAAAUAAAAIAAAAAAAAAAAAAAAEAAAACQAAAAUAAAAGAAAAAAAAAAgAAAAIAAAAAAAAAAQAAAAFAAAAAwAAAAkAAAAGAAAAAwAAAAkAAAABAAAACAAAAAYAAAAFAAAACAAAAAUAAAAAAAAABAAAAAcAAAAJAAAACQAAAAQAAAAAAAAAAwAAAAAAAAAAAAAABwAAAAQAAAAIAAAACAAAAAQAAAACAAAAAwAAAAQAAAAIAAAAAQAAAAMAAAAIAAAAAwAAAAEAAAADAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAACAAAAAIAAAABAAAAAwAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAMAAAACAAAAAQAAAAMAAAAAAAAABgAAAAIAAAAHAAAABQAAAAQAAAAIAAAAAgAAAAEAAAACAAAACQAAAAcAAAAFAAAABwAAAAEAAAACAAAAAwAAAAIAAAAIAAAACQAAAAMAAAAEAAAAAgAAAAYAAAAHAAAAAwAAAAEAAAABAAAABgAAAAAAAAAEAAAAAwAAAAMAAAABAAAAAwAAAAgAAAAFAAAABgAAAAYAAAAEAAAABgAAAAYAAAAJAAAABQAAAAUAAAAFAAAACQAAAAIAAAADAAAABwAAAAEAAAACAAAABwAAAAYAAAAIAAAAAAAAAAEAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAADAAAABAAAAAkAAAAFAAAABgAAAAMAAAAGAAAAAgAAAAMAAAAEAAAABQAAAAMAAAAJAAAABgAAAAMAAAAEAAAAAQAAAAcAAAAGAAAABQAAAAIAAAAFAAAAAwAAAAQAAAAHAAAACQAAAAQAAAAEAAAAAAAAAAMAAAAAAAAAAAAAAAcAAAAEAAAAAgAAAAcAAAAJAAAACAAAAAMAAAAEAAAAAgAAAAEAAAAIAAAAAgAAAAMAAAABAAAAAwAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAUAAAAIAAAAAQAAAAMAAAAAAAAABgAAAAkAAAAHAAAAAQAAAAQAAAACAAAACAAAAAEAAAADAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAACAAAAAcAAAAHAAAABQAAAAcAAAABAAAACAAAAAgAAAAIAAAACAAAAAkAAAADAAAABAAAAAQAAAAGAAAABwAAAAMAAAABAAAAAQAAAAAAAAAAAAAABAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAYAAAAGAAAABAAAAAYAAAAGAAAACQAAAAUAAAAFAAAABQAAAAkAAAAIAAAAAwAAAAcAAAABAAAACAAAAAcAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAEAAAAAwAAAAQAAAAJAAAABQAAAAYAAAADAAAABgAAAAgAAAADAAAABAAAAAUAAAAAAAAACQAAAAYAAAADAAAACQAAAAEAAAAHAAAABgAAAAUAAAAIAAAABQAAAAMAAAAEAAAABwAAAAkAAAAJAAAABAAAAAAAAAACAAAABAAAAAAAAAAHAAAABAAAAAgAAAAHAAAACQAAAAIAAAAIAAAACQAAAAgAAAABAAAAAwAAAAgAAAADAAAAAAAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAgAAAAIAAAAAQAAAAAAAAAAAAAABgAAAAkAAAAIAAAABQAAAAQAAAAIAAAACAAAAAEAAAAAAAAAAAAAAAYAAAAJAAAACAAAAAUAAAAEAAAACAAAAAgAAAABAAAACAAAAAgAAAAIAAAABQAAAAgAAAABAAAACAAAAAgAAAAIAAAAAwAAAAkAAAAGAAAABAAAAAQAAAAGAAAACAAAAAAAAAAAAAAABAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAYAAAAGAAAABAAAAAYAAAAGAAAACQAAAAUAAAAFAAAABQAAAAkAAAAIAAAAAAAAAAgAAAABAAAACAAAAAgAAAAAAAAACAAAAAAAAAABAAAAAQAAAAAAAAAEAAAABQAAAAYAAAAAAAAAAAAAAAkAAAAFAAAABgAAAAAAAAAGAAAACAAAAAAAAAAEAAAABQAAAAgAAAAJAAAABgAAAAAAAAAJAAAAAQAAAAcAAAAGAAAABQAAAAgAAAAFAAAAAAAAAAQAAAAIAAAACQAAAAkAAAAEAAAAAAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAJAAAACQAAAAgAAAABAAAACAAAAAgAAAAIAAAAAQAAAAMAAAAAAAAABgAAAAkAAAAHAAAABQAAAAQAAAAEAAAABgAAAAEAAAADAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAAAwAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAgAAAAIAAAAAQAAAAgAAAAHAAAABwAAAAUAAAAHAAAAAQAAAAgAAAAIAAAACAAAAAMAAAAJAAAAAwAAAAQAAAAEAAAABgAAAAcAAAADAAAAAQAAAAEAAAAEAAAAAwAAAAAAAAABAAAAAwAAAAAAAAAFAAAABgAAAAYAAAAEAAAABgAAAAYAAAAJAAAABQAAAAUAAAAFAAAABAAAAAgAAAADAAAABwAAAAEAAAAHAAAABwAAAAAAAAAGAAAABgAAAAEAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAADAAAABAAAAAkAAAAFAAAABgAAAAMAAAAEAAAACAAAAAMAAAAEAAAABQAAAAMAAAAJAAAABgAAAAMAAAAJAAAAAQAAAAcAAAAGAAAABQAAAAgAAAAFAAAAAwAAAAQAAAAHAAAACQAAAAkAAAAEAAAAAAAAAAMAAAAAAAAAAAAAAAcAAAAEAAAACAAAAAcAAAAJAAAAAAAAAAYAAAAJAAAACAAAAAEAAAADAAAACAAAAAMAAAABAAAAAgAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAYAAAAIAAAAAQAAAAIAAAAAAAAABgAAAAkAAAAHAAAABQAAAAQAAAADAAAACAAAAAEAAAADAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAACAAAAAcAAAAHAAAABQAAAAcAAAABAAAACAAAAAcAAAAIAAAABwAAAAkAAAADAAAABAAAAAQAAAAEAAAABwAAAAMAAAABAAAAAQAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAQAAAAMAAAAAAAAABQAAAAYAAAAGAAAABAAAAAYAAAAGAAAACQAAAAUAAAAFAAAABQAAAAkAAAAIAAAAAwAAAAcAAAABAAAACAAAAAcAAAAAAAAABwAAAAAAAAABAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAwAAAAQAAAAJAAAABQAAAAYAAAADAAAABgAAAAgAAAADAAAABAAAAAUAAAADAAAACQAAAAYAAAADAAAACQAAAAEAAAAHAAAABgAAAAUAAAAIAAAABQAAAAcAAAAEAAAABwAAAAkAAAAJAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAABAAAAAgAAAAHAAAACQAAAAMAAAADAAAACQAAAAgAAAABAAAAAwAAAAgAAAADAAAAAQAAAAIAAAAAAAAABgAAAAkAAAAIAAAABQAAAAQAAAADAAAACAAAAAEAAAADAAAAAAAAAAYAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAAAgAAAAYAAAAGAAAACQAAAAcAAAAFAAAABAAAAAMAAAAIAAAAAQAAAAgAAAAHAAAABwAAAAUAAAAHAAAAAQAAAAgAAAADAAAACAAAAAMAAAAJAAAAAwAAAAQAAAAEAAAABgAAAAcAAAADAAAAAQAAAAEAAAAGAAAABgAAAAQAAAADAAAABgAAAAEAAAACAAAABgAAAAUAAAAGAAAABgAAAAQAAAAGAAAABgAAAAkAAAAFAAAABQAAAAUAAAAJAAAACAAAAAMAAAAHAAAAAQAAAAgAAAAFAAAAAAAAAAMAAAAGAAAAAQAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAMAAAAEAAAACQAAAAUAAAAGAAAAAwAAAAYAAAAIAAAAAwAAAAQAAAAFAAAAAwAAAAkAAAAGAAAAAwAAAAkAAAABAAAABwAAAAYAAAAFAAAACAAAAAUAAAADAAAABAAAAAcAAAAJAAAACQAAAAQAAAAIAAAAAwAAAAAAAAAAAAAACAAAAAQAAAAIAAAABwAAAAkAAAADAAAAAwAAAAkAAAAIAAAAAQAAAAMAAAABAAAAAgAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAgAAAAIAAAAAQAAAAIAAAAAAAAABgAAAAkAAAAIAAAABQAAAAQAAAAIAAAACAAAAAEAAAACAAAAAAAAAAYAAAAJAAAACAAAAAUAAAAEAAAACAAAAAgAAAABAAAACAAAAAgAAAAIAAAABQAAAAgAAAABAAAACAAAAAgAAAAIAAAACAAAAAkAAAACAAAABAAAAAQAAAAGAAAACAAAAAIAAAABAAAAAQAAAAAAAAAAAAAABAAAAAIAAAAAAAAAAQAAAAIAAAAAAAAABQAAAAYAAAAGAAAABAAAAAYAAAAGAAAACQAAAAUAAAAFAAAABQAAAAkAAAAIAAAAAgAAAAgAAAABAAAACAAAAAcAAAAAAAAACAAAAAAAAAABAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAQAAAAJAAAABQAAAAYAAAACAAAABgAAAAgAAAACAAAABAAAAAUAAAAIAAAACQAAAAYAAAACAAAACQAAAAEAAAAIAAAABgAAAAUAAAAIAAAABQAAAAIAAAAEAAAACAAAAAkAAAAJAAAABAAAAAAAAAAIAAAAAAAAAAAAAAAHAAAABAAAAAgAAAAHAAAACQAAAAgAAAAHAAAACQAAAAYAAAABAAAABwAAAAgAAAAIAAAAAQAAAAMAAAAAAAAABgAAAAkAAAAHAAAAAgAAAAMAAAADAAAAAgAAAAEAAAADAAAABgAAAAYAAAAJAAAABwAAAAUAAAACAAAAAQAAAAMAAAAAAAAABgAAAAkAAAAHAAAABQAAAAQAAAAHAAAAAgAAAAkAAAACAAAABwAAAAcAAAAFAAAABwAAAAEAAAAHAAAAAwAAAAcAAAADAAAACQAAAAMAAAAEAAAABAAAAAMAAAAHAAAAAwAAAAEAAAABAAAAAQAAAAAAAAADAAAAAwAAAAYAAAABAAAAAwAAAAAAAAAFAAAAAwAAAAQAAAAEAAAABAAAAAMAAAAJAAAABQAAAAUAAAAFAAAAAwAAAAIAAAADAAAABwAAAAEAAAAIAAAABwAAAAYAAAADAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAwAAAAQAAAADAAAABQAAAAYAAAADAAAABgAAAAQAAAADAAAABAAAAAUAAAADAAAACQAAAAYAAAADAAAACQAAAAEAAAAHAAAABgAAAAUAAAAGAAAABQAAAAMAAAAEAAAABwAAAAkAAAAJAAAABAAAAAAAAAAGAAAABwAAAAQAAAAGAAAABwAAAAQAAAAJAAAABwAAAAEAAAADAAAABwAAAAQAAAABAAAAAwAAAAAAAAAGAAAACQAAAAcAAAAFAAAABAAAAAYAAAAIAAAAAQAAAAMAAAAAAAAAAwAAAAkAAAAHAAAABQAAAAQAAAADAAAACAAAAAEAAAADAAAAAAAAAAcAAAAJAAAABwAAAAUAAAAEAAAAAwAAAAgAAAABAAAACAAAAAcAAAAHAAAABQAAAAcAAAABAAAACAAAAAgAAAAIAAAAAwAAAAkAAAADAAAABAAAAAQAAAAEAAAABwAAAAMAAAABAAAAAQAAAAAAAAAAAAAABAAAAAMAAAAAAAAAAQAAAAMAAAAAAAAABQAAAAMAAAADAAAABAAAAAgAAAADAAAACQAAAAUAAAAFAAAABQAAAAkAAAAIAAAAAwAAAAcAAAABAAAACAAAAAgAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAwAAAAQAAAAJAAAABQAAAAYAAAADAAAABgAAAAgAAAADAAAABAAAAAUAAAADAAAACQAAAAcAAAADAAAACQAAAAEAAAAIAAAABgAAAAUAAAAIAAAABQAAAAMAAAAEAAAABwAAAAkAAAAJAAAABAAAAAAAAAADAAAAAAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACQAAAAMAAAADAAAACQAAAAgAAAABAAAAAwAAAAgAAAAIAAAA"},"shape":[1797],"dtype":"int32","order":"little"}]]}}},"view":{"type":"object","name":"CDSView","id":"p1044","attributes":{"filter":{"type":"object","name":"AllIndices","id":"p1045"}}},"glyph":{"type":"object","name":"Scatter","id":"p1040","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":8},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.6},"fill_color":{"type":"field","field":"color"},"fill_alpha":{"type":"value","value":0.6},"hatch_color":{"type":"field","field":"color"}}},"nonselection_glyph":{"type":"object","name":"Scatter","id":"p1041","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":8},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.1},"fill_color":{"type":"field","field":"color"},"fill_alpha":{"type":"value","value":0.1},"hatch_color":{"type":"field","field":"color"},"hatch_alpha":{"type":"value","value":0.1}}},"muted_glyph":{"type":"object","name":"Scatter","id":"p1042","attributes":{"x":{"type":"field","field":"x"},"y":{"type":"field","field":"y"},"size":{"type":"value","value":8},"line_color":{"type":"field","field":"color"},"line_alpha":{"type":"value","value":0.2},"fill_color":{"type":"field","field":"color"},"fill_alpha":{"type":"value","value":0.2},"hatch_color":{"type":"field","field":"color"},"hatch_alpha":{"type":"value","value":0.2}}}}}],"toolbar":{"type":"object","name":"Toolbar","id":"p1010","attributes":{"tools":[{"type":"object","name":"PanTool","id":"p1023"},{"type":"object","name":"WheelZoomTool","id":"p1024","attributes":{"renderers":"auto"}},{"type":"object","name":"BoxZoomTool","id":"p1025","attributes":{"overlay":{"type":"object","name":"BoxAnnotation","id":"p1026","attributes":{"syncable":false,"level":"overlay","visible":false,"left":{"type":"number","value":"nan"},"right":{"type":"number","value":"nan"},"top":{"type":"number","value":"nan"},"bottom":{"type":"number","value":"nan"},"left_units":"canvas","right_units":"canvas","top_units":"canvas","bottom_units":"canvas","line_color":"black","line_alpha":1.0,"line_width":2,"line_dash":[4,4],"fill_color":"lightgrey","fill_alpha":0.5}}}},{"type":"object","name":"SaveTool","id":"p1031"},{"type":"object","name":"ResetTool","id":"p1032"},{"type":"object","name":"HelpTool","id":"p1033"},{"type":"object","name":"HoverTool","id":"p1048","attributes":{"renderers":[{"id":"p1043"}],"tooltips":[["Digit","@digit"],["Cluster","@cluster"]]}}]}},"left":[{"type":"object","name":"LinearAxis","id":"p1018","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1019","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1020"},"axis_label":"Principal Component 2","major_label_policy":{"type":"object","name":"AllLabels","id":"p1021"}}}],"below":[{"type":"object","name":"LinearAxis","id":"p1013","attributes":{"ticker":{"type":"object","name":"BasicTicker","id":"p1014","attributes":{"mantissas":[1,2,5]}},"formatter":{"type":"object","name":"BasicTickFormatter","id":"p1015"},"axis_label":"Principal Component 1","major_label_policy":{"type":"object","name":"AllLabels","id":"p1016"}}}],"center":[{"type":"object","name":"Grid","id":"p1017","attributes":{"axis":{"id":"p1013"}}},{"type":"object","name":"Grid","id":"p1022","attributes":{"dimension":1,"axis":{"id":"p1018"}}},{"type":"object","name":"Legend","id":"p1046","attributes":{"title":"Digit","label_text_font_size":"10pt","items":[{"type":"object","name":"LegendItem","id":"p1047","attributes":{"label":{"type":"field","field":"digit"},"renderers":[{"id":"p1043"}]}}]}}]}}]}};
  const render_items = [{"docid":"c59c7d52-4b71-401c-bf71-6f1d84221d2a","roots":{"p1001":"b69d7d11-9570-46f6-9d4d-e5e1fbaadde4"},"root_ids":["p1001"]}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);
  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    let attempts = 0;
    const timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);</script></div>
</div>
</section>
<section id="calinski-harabasz-index">
<h2>Calinski-Harabasz index<a class="headerlink" href="#calinski-harabasz-index" title="Permalink to this heading">#</a></h2>
<p>The <strong>Calinski-Harabasz index</strong> (also known as the <strong>Variance Ratio Criterion</strong>) is calculated as a ratio of the sum of inter-cluster dispersion and the sum of intra-cluster dispersion for all clusters (where the dispersion is the sum of squared distances).</p>
<p>The <strong>Calinski-Harabasz index</strong> (CH) is a way to measure how well a K-Means clustering algorithm divides data into clusters. It helps assess the effectiveness of the algorithm in creating meaningful groups when a specific number of clusters is used.</p>
<section id="how-do-you-interpret-calinski-harabasz-index">
<h3>How do you interpret Calinski-Harabasz index?<a class="headerlink" href="#how-do-you-interpret-calinski-harabasz-index" title="Permalink to this heading">#</a></h3>
<p>A high <strong>Calinski-Harabasz index</strong> (CH) indicates improved clustering because it signifies that data points within each cluster are closely packed (denser), while the clusters themselves are well-separated from one another.</p>
<p>In the upcoming section, we’ll delve into a detailed explanation of how to calculate the CH, complete with a few illustrative examples.</p>
<p>To proceed with this tutorial, make sure you have the following Python libraries installed: <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>.</p>
<p>####Calinski-Harabasz Index Explained</p>
<p>In this section, we will break down each calculation step and offer insightful examples to enhance your comprehension of the formulas.</p>
<p>STEP 1</p>
<p>Initially, we calculate the inter-cluster dispersion, also known as the between-group sum of squares (BGSS).</p>
<p>In the CH context, inter-cluster dispersion gauges the weighted sum of squared distances between the centroids of clusters and the centroid of the entire dataset (barycenter).</p>
<p>The calculation for the between-group sum of squares is as follows:</p>
<div class="math notranslate nohighlight">
\[\text{BGSS} = \sum_{k=1}^{K}  n_k \cdot \|\mathbf{C}_k - \mathbf{C}\|^2\]</div>
<p>Here are the key terms used in the formula:</p>
<ul class="simple">
<li><p><strong>n<sub>k</sub></strong>: the number of observations in cluster <strong>k</strong>.</p></li>
<li><p><strong>C<sub>k</sub></strong>: the centroid of cluster <strong>k</strong>.</p></li>
<li><p><strong>C</strong>: the centroid of the dataset (barycenter).</p></li>
<li><p><strong>K</strong>: the number of clusters.</p></li>
</ul>
<div style="display:none" id="q_bgss">W3sicXVlc3Rpb24iOiAiV2hhdCBkb2VzIEJHU1Mgc3RhbmQgZm9yIGluIHRoZSBjb250ZXh0IG9mIHRoZSBDYWxpbnNraS1IYXJhYmFzeiBJbmRleD8iLCAidHlwZSI6ICJtYW55X2Nob2ljZSIsICJhbnN3ZXJzIjogW3siYW5zd2VyIjogIkJldHdlZW4gR3JvdXAgU3RhbmRhcmQgU3VtIiwgImNvcnJlY3QiOiBmYWxzZSwgImZlZWRiYWNrIjogIkluY29ycmVjdCEifSwgeyJhbnN3ZXIiOiAiQmV0d2VlbiBHcm91cCBTdW0gb2YgU3F1YXJlcyIsICJjb3JyZWN0IjogdHJ1ZSwgImZlZWRiYWNrIjogIkNvcnJlY3QhIn0sIHsiYW5zd2VyIjogIkJhcnljZW50ZXIgR3JvdXAgU3F1YXJlZCBTdW0iLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9LCB7ImFuc3dlciI6ICJCYWxhbmNlZCBHcm91cCBTdW0iLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9XX1d</div><div style="display:none" id="q_inter_cluster_measure">W3sicXVlc3Rpb24iOiAiV2hhdCBkb2VzIHRoZSBpbnRlci1jbHVzdGVyIGRpc3BlcnNpb24gbWVhc3VyZSBpbiB0aGUgQ2FsaW5za2ktSGFyYWJhc3ogSW5kZXg/IiwgInR5cGUiOiAibWFueV9jaG9pY2UiLCAiYW5zd2VycyI6IFt7ImFuc3dlciI6ICJXaXRoaW4gR3JvdXAgU3VtIG9mIFNxdWFyZXMiLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9LCB7ImFuc3dlciI6ICJXZWlnaHRlZCBzdW0gb2Ygc3F1YXJlZCBkaXN0YW5jZXMgYmV0d2VlbiBjZW50cm9pZHMiLCAiY29ycmVjdCI6IHRydWUsICJmZWVkYmFjayI6ICJDb3JyZWN0ISJ9LCB7ImFuc3dlciI6ICJUb3RhbCBudW1iZXIgb2Ygb2JzZXJ2YXRpb25zIiwgImNvcnJlY3QiOiBmYWxzZSwgImZlZWRiYWNrIjogIkluY29ycmVjdCEifSwgeyJhbnN3ZXIiOiAiVG90YWwgc3VtIG9mIHNxdWFyZXMiLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9XX1d</div><div style="display:none" id="q_bggs_calculation">W3sicXVlc3Rpb24iOiAiSG93IGlzIHRoZSBiZXR3ZWVuIGdyb3VwIHN1bSBvZiBzcXVhcmVzIChCR1NTKSBjYWxjdWxhdGVkPyIsICJ0eXBlIjogIm1hbnlfY2hvaWNlIiwgImFuc3dlcnMiOiBbeyJhbnN3ZXIiOiAiQkdTUyA9IFx1MjIxMShDayAtIEMpIiwgImNvcnJlY3QiOiBmYWxzZSwgImZlZWRiYWNrIjogIkluY29ycmVjdCEifSwgeyJhbnN3ZXIiOiAiQkdTUyA9IFx1MjIxMShuayBcdTAwZDcgfHxDayAtIEN8fF4yKSIsICJjb3JyZWN0IjogdHJ1ZSwgImZlZWRiYWNrIjogIkNvcnJlY3QhIn0sIHsiYW5zd2VyIjogIkJHU1MgPSBcdTIyMTEobmsgLSBDayAtIEMpXjIiLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9LCB7ImFuc3dlciI6ICJCR1NTID0gSyBcdTAwZDcgXHUyMjExKHx8Q2sgLSBDfHxeMikiLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9XX1d</div><div style="display:none" id="q_nk">W3sicXVlc3Rpb24iOiAiV2hhdCBkb2VzICduaycgcmVwcmVzZW50IGluIHRoZSBCR1NTIGZvcm11bGE/IiwgInR5cGUiOiAibWFueV9jaG9pY2UiLCAiYW5zd2VycyI6IFt7ImFuc3dlciI6ICJUb3RhbCBudW1iZXIgb2YgY2x1c3RlcnMiLCAiY29ycmVjdCI6IGZhbHNlLCAiZmVlZGJhY2siOiAiSW5jb3JyZWN0ISJ9LCB7ImFuc3dlciI6ICJUaGUgbnVtYmVyIG9mIG9ic2VydmF0aW9ucyBpbiBjbHVzdGVyIGsiLCAiY29ycmVjdCI6IHRydWUsICJmZWVkYmFjayI6ICJDb3JyZWN0ISJ9LCB7ImFuc3dlciI6ICJCYXJ5Y2VudGVyIG9mIHRoZSBkYXRhc2V0IiwgImNvcnJlY3QiOiBmYWxzZSwgImZlZWRiYWNrIjogIkluY29ycmVjdCEifSwgeyJhbnN3ZXIiOiAiQmV0d2VlbiBHcm91cCBTdW0gb2YgU3F1YXJlcyIsICJjb3JyZWN0IjogZmFsc2UsICJmZWVkYmFjayI6ICJJbmNvcnJlY3QhIn1dfV0=</div><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="ZMGWXxGcblSC" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#ZMGWXxGcblSC {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_bgss");
            var questionsZMGWXxGcblSC;
            try {
               questionsZMGWXxGcblSC=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionsZMGWXxGcblSC = JSON.parse(element.innerHTML);
            }
            console.log(questionsZMGWXxGcblSC);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("ZMGWXxGcblSC")) {
            show_questions(questionsZMGWXxGcblSC,  ZMGWXxGcblSC); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("ZMGWXxGcblSC");
        // console.log(document.getElementById("ZMGWXxGcblSC"));

        try_show();
        }
        </script><div class="output text_html"><div id="mhkUQKbNsNWv" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#mhkUQKbNsNWv {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_inter_cluster_measure");
            var questionsmhkUQKbNsNWv;
            try {
               questionsmhkUQKbNsNWv=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionsmhkUQKbNsNWv = JSON.parse(element.innerHTML);
            }
            console.log(questionsmhkUQKbNsNWv);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("mhkUQKbNsNWv")) {
            show_questions(questionsmhkUQKbNsNWv,  mhkUQKbNsNWv); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("mhkUQKbNsNWv");
        // console.log(document.getElementById("mhkUQKbNsNWv"));

        try_show();
        }
        </script><div class="output text_html"><div id="XSKtyQmOIfFp" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#XSKtyQmOIfFp {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_bggs_calculation");
            var questionsXSKtyQmOIfFp;
            try {
               questionsXSKtyQmOIfFp=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionsXSKtyQmOIfFp = JSON.parse(element.innerHTML);
            }
            console.log(questionsXSKtyQmOIfFp);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("XSKtyQmOIfFp")) {
            show_questions(questionsXSKtyQmOIfFp,  XSKtyQmOIfFp); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("XSKtyQmOIfFp");
        // console.log(document.getElementById("XSKtyQmOIfFp"));

        try_show();
        }
        </script><div class="output text_html"><div id="qhnzLIPpFuyM" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#qhnzLIPpFuyM {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_nk");
            var questionsqhnzLIPpFuyM;
            try {
               questionsqhnzLIPpFuyM=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionsqhnzLIPpFuyM = JSON.parse(element.innerHTML);
            }
            console.log(questionsqhnzLIPpFuyM);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("qhnzLIPpFuyM")) {
            show_questions(questionsqhnzLIPpFuyM,  qhnzLIPpFuyM); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("qhnzLIPpFuyM");
        // console.log(document.getElementById("qhnzLIPpFuyM"));

        try_show();
        }
        </script></div>
</div>
<p>STEP 2</p>
<p>Next, the second step involves calculating the intra-cluster dispersion, or the within-group sum of squares (WGSS).</p>
<p>In the CH context, intra-cluster dispersion assesses the sum of squared distances between each observation and the centroid of its corresponding cluster.</p>
<p>For each cluster <strong>k</strong> we will compute the <strong>WGSS<sub>k</sub></strong> as:</p>
<div class="math notranslate nohighlight">
\[\text{WGSS}_k = \sum_{k=1}^{{n_k}}  \|\mathbf{X}_ik - \mathbf{C}_k\|^2\]</div>
<p>Here are the key terms used in the formula:</p>
<ul class="simple">
<li><p><strong>n<sub>k</sub></strong>: the number of observations in cluster <strong>k</strong>.</p></li>
<li><p><strong>X<sub>ik</sub></strong>: the i-th observation of cluster <strong>k</strong>.</p></li>
<li><p><strong>C<sub>k</sub></strong>:  the centroid of cluster <strong>k</strong>.</p></li>
</ul>
<p>And then sum all individual within group sums of squares:
$<span class="math notranslate nohighlight">\(\text{WGSS} = \sum_{k=1}^{K} \mathbf{WGSS}_k\)</span>$</p>
<p>Here are the key terms used in the formula:</p>
<ul class="simple">
<li><p><strong>WGSS<sub>k</sub></strong>: the within group sum of squares of cluster <strong>k</strong>.</p></li>
<li><p><strong>K</strong>:   the number of clusters.</p></li>
</ul>
<div style="display:none" id="q_demo_seq">W3sicXVlc3Rpb24iOiAiRm9yIGNsdXN0ZXIgaywgaWYgbmsgPSA1IGFuZCB0aGUgY2VudHJvaWQgQ2sgaGFzIGNvb3JkaW5hdGVzICgyLCAzKSwgY2FsY3VsYXRlIHRoZSBpbnRyYS1jbHVzdGVyIGRpc3BlcnNpb24gKFdHU1NrKSB1c2luZyB0aGUgZm9ybXVsYSBXR1NTay4gUHJvdmlkZSB5b3VyIG51bWVyaWMgYW5zd2VyIiwgInR5cGUiOiAibnVtZXJpYyIsICJhbnN3ZXJzIjogW3sidHlwZSI6ICJ2YWx1ZSIsICJ2YWx1ZSI6IDI1LCAiY29ycmVjdCI6IHRydWUsICJmZWVkYmFjayI6ICJUUlVFIn0sIHsidHlwZSI6ICJkZWZhdWx0IiwgImZlZWRiYWNrIjogIkZBTFNFIn1dfV0=</div><div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_html"><div id="mEEdMqrLJRkl" data-shufflequestions="False"
               data-shuffleanswers="True"
               data-preserveresponses="false"
               data-numquestions="1000000"
               data-maxwidth="600"
               style="border-radius: 10px; text-align: left"> <style>
#mEEdMqrLJRkl {
   --jq-multiple-choice-bg: #6f78ffff;
   --jq-mc-button-bg: #fafafa;
   --jq-mc-button-border: #e0e0e0e0;
   --jq-mc-button-inset-shadow: #555555;
   --jq-many-choice-bg: #f75c03ff;
   --jq-numeric-bg: #392061ff;
   --jq-numeric-input-bg: #c0c0c0;
   --jq-numeric-input-label: #101010;
   --jq-numeric-input-shadow: #999999;
   --jq-incorrect-color: #c80202;
   --jq-correct-color: #009113;
   --jq-text-color: #fafafa;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
    border-radius: inherit;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-gap: 10px;
    border-radius: inherit;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: var(--jq-numeric-input-bg);
    color: var(--jq-text-color);
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: var(--jq-numeric-input-bg);
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem var(--jq-numeric-input-shadow);
}

.MCButton {
    background: var(--jq-mc-button-bg);
    border: 1px solid var(--jq-mc-button-border);
    border-radius: inherit;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--jq-multiple-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--jq-many-choice-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn {
    padding: 10px;
    background: var(--jq-numeric-bg);
    color: var(--jq-text-color);
    border-radius: inherit;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: var(--jq-numeric-input-label);
    font-size: 15pt;
}

.incorrect {
    color: var(--jq-incorrect-color);
}

.correct {
    color: var(--jq-correct-color);
}

.correctButton {
    /*
    background: var(--jq-correct-color);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: var(--jq-text-color);
    box-shadow: inset 0px 0px 5px var(--jq-mc-button-inset-shadow);
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--jq-incorrect-color);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--jq-correct-color);
    }
}
</style></div><script type="application/javascript">var element=document.getElementById("q_demo_seq");
            var questionsmEEdMqrLJRkl;
            try {
               questionsmEEdMqrLJRkl=JSON.parse(window.atob(element.innerHTML));
            } catch(err) {
               console.log("Fell into catch");
               questionsmEEdMqrLJRkl = JSON.parse(element.innerHTML);
            }
            console.log(questionsmEEdMqrLJRkl);;
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            var sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            var precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        var answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    if ("feedback" in answer) {
                        fb.textContent = jaxify(answer.feedback);
                    } else {
                        fb.textContent = jaxify("Correct");
                    }
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            var parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        var edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    var count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    var count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;
    var max_width = mydiv.dataset.maxwidth;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        iDiv.style.maxWidth  =max_width+"px";
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;
        
        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;
        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        
        if (qa.question) {
            iDiv.append(outerqDiv);

            //qDiv.textContent=qa.question;
            qDiv.innerHTML = jaxify(qa.question);
            outerqDiv.append(qDiv);
        }

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if ((qa.type == "multiple_choice") || (qa.type == "many_choice") ) {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
            if ("answer_cols" in qa) {
                //aDiv.style.gridTemplateColumns = 'auto '.repeat(qa.answer_cols);
                aDiv.style.gridTemplateColumns = 'repeat(' + qa.answer_cols + ', 1fr)';
            }
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}
/* This is to handle asynchrony issues in loading Jupyter notebooks
           where the quiz has been previously run. The Javascript was generally
           being run before the div was added to the DOM. I tried to do this
           more elegantly using Mutation Observer, but I didn't get it to work.

           Someone more knowledgeable could make this better ;-) */

        function try_show() {
          if(document.getElementById("mEEdMqrLJRkl")) {
            show_questions(questionsmEEdMqrLJRkl,  mEEdMqrLJRkl); 
          } else {
             setTimeout(try_show, 200);
          }
        };
    
        {
        // console.log(element);

        //console.log("mEEdMqrLJRkl");
        // console.log(document.getElementById("mEEdMqrLJRkl"));

        try_show();
        }
        </script></div>
</div>
<p>Step 3: Calculate Calinski-Harabasz Index</p>
<p>The Calinski-Harabasz index is determined by summing the inter-cluster dispersion and the intra-cluster dispersion across all clusters.</p>
<p>The calculation for the Calinski-Harabasz index is as follows:</p>
<div class="math notranslate nohighlight">
\[\text{WGSS} = \frac{ \frac{BGSS}{K-1} }{ \frac{WGSS}{N-K} } = \frac{BGSS}{WGSS} \times \frac{N-K}{K-1}\]</div>
<p>Here are the key terms used in the formula:</p>
<ul class="simple">
<li><p><strong>BGSS</strong>:   between-group sum of squares (between-group dispersion).</p></li>
<li><p><strong>WGSS</strong>:   within-group sum of squares (within-group dispersion).</p></li>
<li><p><strong>N</strong>:   total number of observations.</p></li>
<li><p><strong>K</strong>:  total number of clusters.</p></li>
</ul>
<p>From the above formula, we can conclude that the large values of Calinski-Harabasz index represent better clustering.</p>
</section>
<section id="calinski-harabasz-index-example-in-python">
<h3>Calinski-Harabasz Index Example in Python<a class="headerlink" href="#calinski-harabasz-index-example-in-python" title="Permalink to this heading">#</a></h3>
<p>In this part, we’ll walk through an example of computing the Calinski-Harabasz index for a K-Means clustering algorithm in Python.</p>
<p>To begin, import the necessary dependencies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">calinski_harabasz_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>Feel free to utilize any dataset with the provided code. For simplicity, we’ll use the built-in Iris dataset, focusing specifically on the first two features: “sepal width” and “sepal length”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll begin by setting the target for K-Means to have 3 clusters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And check the Calinski-Harabasz index for the above results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ch_index</span> <span class="o">=</span> <span class="n">calinski_harabasz_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ch_index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>185.33266845949427
</pre></div>
</div>
</div>
</div>
<p>You should get the resulting score: <strong>185.33266845949427</strong> or approximately (<strong>185.33</strong>).</p>
<p>To put in perspective how the clusters look , let’s visualize them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;grey&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">unique_labels</span><span class="p">:</span>
    <span class="n">filtered_label</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">labels</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">filtered_label</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">filtered_label</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Sepal length&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Sepal width&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7a31bf3c6b18c52418feea0caf91236551221793eaa4beed7df9a2df1d6c9c0b.png" src="../_images/7a31bf3c6b18c52418feea0caf91236551221793eaa4beed7df9a2df1d6c9c0b.png" />
</div>
</div>
<p>We should see the following original 3 clusters (<strong>above</strong>)</p>
<p>Given that we computed the CH index for 3 clusters and the original data has 3 labels, we expect the CH index to be highest for 3 clusters compared to other cluster numbers.</p>
<p>Now, let’s compute the CH index for a range of cluster numbers and identify the highest values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">db_index</span> <span class="o">=</span> <span class="n">calinski_harabasz_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
    <span class="n">results</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">i</span><span class="p">:</span> <span class="n">db_index</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<p>and visualize it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of clusters&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Calinski-Harabasz Index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/65411cb7b4332fb231333736daa836f1e6b918ab296498c9ce498f9ad5e6ae66.png" src="../_images/65411cb7b4332fb231333736daa836f1e6b918ab296498c9ce498f9ad5e6ae66.png" />
</div>
</div>
<p>An interesting observation emerges as 5 clusters and 10 clusters yield a higher Calinski-Harabasz index value compared to 3 clusters, despite the actual number of labels in the data being 3.</p>
<p>It’s worth noting that while we can obtain higher CH index values for cluster numbers other than 3, the index values remain within a very close range, roughly between 175 and 200.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./unsupervised_learning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pca.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Principal components analysis (PCA)</p>
      </div>
    </a>
    <a class="right-next"
       href="k_means.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">K-means</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Clustering metrics</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#silhouette-score">Silhouette Score</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-silhouette-score-in-python">Calculating Silhouette Score in Python</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#davies-bouldin-index">Davies-Bouldin Index</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lower-vs-higher-db-index-values">Lower vs. Higher DB Index Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#syntax">Syntax</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-2">Implementation 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#question">Question</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#adjusted-rand-index-ari">Adjusted Rand Index (ARI)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-digits-dataset">Example: Digits Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calinski-harabasz-index">Calinski-Harabasz index</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-do-you-interpret-calinski-harabasz-index">How do you interpret Calinski-Harabasz index?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calinski-harabasz-index-example-in-python">Calinski-Harabasz Index Example in Python</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By KBTU
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>